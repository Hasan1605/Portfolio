(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[251,156,196,269,283,303],{592:function(e,t,n){"use strict";n.r(t);var r=n(15),i=n(0),s=n(10),o=n(12);Object(o.n)([{rawString:".od-FilePicker{position:absolute;top:0;bottom:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;z-index:280}.od-FilePicker-content{overflow-y:hidden;position:absolute;bottom:0;left:0;right:0;top:0;overflow-y:scroll;-webkit-overflow-scrolling:touch}.od-FilePicker-innerContent{position:relative;min-height:100%;padding-bottom:32px;box-sizing:border-box}.lg .od-FilePicker-innerContent,.md .od-FilePicker-innerContent,.xlg .od-FilePicker-innerContent,.xxlg .od-FilePicker-innerContent,.xxxlg .od-FilePicker-innerContent,.xxxxlg .od-FilePicker-innerContent{padding-bottom:70px}.sm .od-FilePicker-innerContent{padding-bottom:100px}.od-FilePicker-loadingDiv{position:absolute;top:0;left:0;right:0;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(255,255,255,0))}"}]);n(267);Object(o.n)([{rawString:".od-ItemPicker{position:absolute;top:0;left:0;bottom:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:flex;flex-direction:column}.od-ItemPicker-pickerWrapper{position:relative;flex:1 1 auto}.od-ItemPicker-picker{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;flex-direction:row}.od-ItemPicker-picker{display:flex}.od-ItemPicker-main{display:flex;flex-direction:column;flex:1 1 auto}.od-ItemPicker-branding{flex:0 0 auto;height:50px}.od-ItemPicker-search{padding:0 32px;margin-top:16px;max-width:468px}.md .od-ItemPicker-search,.sm .od-ItemPicker-search{padding-left:16px;padding-right:16px}.od-ItemPicker-topBar{flex:0 0 auto;height:40px}.md .od-ItemPicker-topBar,.sm .od-ItemPicker-topBar{height:44px}.od-ItemPicker-leftPane{flex:0 0 auto;width:208px;box-sizing:border-box}html[dir=ltr] .od-ItemPicker-leftPane{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=rtl] .od-ItemPicker-leftPane{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.md .od-ItemPicker-commandBar,.sm .od-ItemPicker-commandBar{padding-left:4px;padding-right:4px}.lg .od-ItemPicker-commandBar,.xlg .od-ItemPicker-commandBar,.xxlg .od-ItemPicker-commandBar,.xxxlg .od-ItemPicker-commandBar,.xxxxlg .od-ItemPicker-commandBar{padding-left:16px;padding-right:16px}.od-ItemPicker-selector{flex:1 1 auto;position:relative}.od-ItemPicker-actions{flex:0 0 auto;height:50px;box-sizing:border-box;padding:10px 20px}html[dir=ltr] .od-ItemPicker-actions{text-align:right}html[dir=rtl] .od-ItemPicker-actions{text-align:left}.od-ItemPicker-actions .od-Button--primary:enabled,.od-ItemPicker-actions .od-Button:active{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPicker-actions .od-ButtonBarCommand--text{font-size:12px}.od-ItemPicker .DetailsRow,.od-ItemPicker .ItemTile{opacity:.3}.od-ItemPicker .DetailsRow.can-select,.od-ItemPicker .DetailsRow.od-DetailsRow--isInvokable,.od-ItemPicker .DetailsRow.od-ItemTile--isInvokable,.od-ItemPicker .ItemTile.can-select,.od-ItemPicker .ItemTile.od-DetailsRow--isInvokable,.od-ItemPicker .ItemTile.od-ItemTile--isInvokable{opacity:1}.od-ItemPicker-secureExperienceStatus{font-style:italic}.od-ItemPicker-secureExperienceStatus--failed{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{position:absolute;top:40px;bottom:0;width:272px;box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;opacity:0}[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{left:0}[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{right:0}html[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay:focus{outline:1px solid transparent}.md .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay,.sm .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{top:44px}.od-OverlayHost-overlay .od-ItemPicker-leftPaneModal{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{opacity:1;animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation:none}}"}]);var u=n(2214);n(2828),n(530);Object(o.n)([{rawString:".od-ItemPickerHeader{height:50px;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPickerHeader-application{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-application{left:16px}[dir=rtl] .od-ItemPickerHeader-application{right:16px}.od-ItemPickerHeader-applicationTitle{font-size:21px;font-weight:300}.od-ItemPickerHeader-applicationLogo{display:none}.od-ItemPickerHeader-account{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-account{right:16px}[dir=rtl] .od-ItemPickerHeader-account{left:16px}.od-ItemPickerHeader-accountDropdown{padding:0 4px;height:100%;display:inline-block;font-size:12px;font-weight:300}.od-ItemPickerHeader-accountDropdown .ms-Icon{font-size:14px;vertical-align:middle}[dir=ltr] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-left:4px}[dir=rtl] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-right:4px}.od-ItemPickerHeader-accountDropdown--isEnabled{cursor:pointer}.od-ItemPickerHeader-accountDropdown--isEnabled:hover{background-color:rgba(255,255,255,.28)}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationLogo{display:inline-block;padding-top:5px}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationTitle{display:inline-block;width:0;height:0;overflow:hidden}"}]);var a=n(124),f=n(195),l=n(136),c=n(49),h=n(55),p=n(1537),d=n(14),v=n(1909),m=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.applicationText=v.e;n.addBindingHandlers({dismiss:a.e,imageLoader:f.e});n._identityDataSource=n.resources.consume(d.x);var r=n.resources.consume(p.e),i=n._identityDataSource.getIdentity();n.accountCommand=new(n.managed(l.e))({text:i.email?i.email:i.loginName,engagementName:"SwitchAccountMenu",requiredChildren:1,collapseSingleChildCommands:!1,isPermanent:!0});n.accountCommand.children.push(new(n.managed(l.e))({text:v.g,action:new(n.managed(r.ItemPickerSwitchAccountAction))}));n.accountMenuParams={items:n.accountCommand.children,isOpen:n.accountCommand.isOpen,alignment:n.createObservable(h.e.isRightToLeft?c.e.Left:c.e.Right),left:n.createObservable(h.e.isRightToLeft?"0":"100%"),hasExplicitAlignment:!0};n.applicationLogoUrl=window.require.toUrl("odsp-media/images/filepicker/onedrivelogolight.png");n.isLogoLoaded=n.createObservable(!1);return n}return t})(s.t),g=r.e({tagName:"od-item-picker-header",template:'<div class="od-ItemPickerHeader"><div class="od-ItemPickerHeader-application" data-bind="css:{\'od-ItemPickerHeader-application--hasLogo\':isLogoLoaded}"><span class="od-ItemPickerHeader-applicationLogo"><img data-bind="imageLoader:{src:applicationLogoUrl,isLoaded:isLogoLoaded}"></span><span class="od-ItemPickerHeader-applicationTitle" data-bind="text:applicationText"></span></div><div class="od-ItemPickerHeader-account" data-bind="dismiss:{isOpen:accountCommand.isOpen}"><span class="od-ItemPickerHeader-accountDropdown" data-bind="css:{\'od-ItemPickerHeader-accountDropdown--isOpen\':accountCommand.isOpen,\'od-ItemPickerHeader-accountDropdown--isEnabled\':!accountCommand.isDisabled()},click:accountCommand.onClick.bind(accountCommand)"><span class="od-ItemPickerHeader-accountDropdownLabel" data-bind="text:accountCommand.label"></span>\x3c!--ko ifnot:accountCommand.isDisabled--\x3e<i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e</span>\x3c!--ko if:accountCommand.isOpen--\x3e<div class="od-ItemPickerHeader-accountMenu" data-bind="component:{name:\'ms-contextual-menu\',params:accountMenuParams}"></div>\x3c!--/ko--\x3e</div></div>',viewModel:m,synchronous:!0}),y=n(92),b=n(273),w=n(13),E=n(7),S=n(247),x=n(5),T=n(37),N=n(40),C=n(184),k=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemPickerStatus=n.itemPickerStatus;r._behavior=n.behavior;r._itemsSelection=n.itemsSelection;r._error=r.createObservable();r._application=r.createObservable();r.commandStatus=r.createPureComputed(r._computeCommandStatus);r.commandStatus.equalityComparer=C.e;var i=n.agent;i&&r.trackPromise(i.getApplication()).done(function(e){r._application(e)},function(e){r._error(e)});return r}t.prototype._computeCommandStatus=function(){var e,t=this._itemPickerStatus(),n=this._behavior.viewType,r=this._itemsSelection.maximumSelectedCount,i=this._itemsSelection.selectedCount();1===t.state||(e=t.error?{text:Object(T.pluralSelect)(i,2===n?v.m:v.v,2===n?v.p:v.h),state:S.e.failed}:r&&i>=r?{text:Object(T.format)(2===n?v.l:v.f,r),state:S.e.failed}:this._computeConsentCommandStatus());return e};t.prototype._computeConsentCommandStatus=function(){var e,t=this._application();if(t){var n=this._behavior,r=n.viewType,i=n.linkType,s=n.selectionMode,o=n.accessLevel;e={text:Object(T.format)(2===r&&1===o?v.o:2!==i&&0===o?0===s?v.d:v.c:0===s?v.s:v.i,t.name)}}else this._error()&&(e={text:v.y,state:S.e.failed});return e};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{behavior:p.n,agent:p.t,itemsSelection:x.C,itemPickerStatus:p.r});return t})(E.n),L=Object(N.s)("ItemPickerStatusHelper",k),A=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(L);n._commandStatus=r.commandStatus;n._label=n.createPureComputed(n._computeLabel);n.command=new(n.managed(w.e))({isDisabled:n.createObservable(!0),text:n._label,location:t.location,isHidden:n.createPureComputed(function(){return!n._label()}),state:n.createPureComputed(n._computeState)});return n}t.prototype._computeLabel=function(){var e=this._commandStatus();return e&&e.text};t.prototype._computeState=function(){var e=this._commandStatus();return e&&e.state||S.e.initialized};return t})(E.n),O=n(291),M=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(p.n),i=n.resources.consume(p.e),s=n.resources.consume(p.r),o=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif"),u=r.completeText,a=void 0===u?2===r.viewType&&1===r.accessLevel?v.r:v.n:u,f=r.cancelText,l=void 0===f?v.t:f;n.commands.push(new(n.managed(A))({location:12}).command,new(n.managed(w.e))({location:12,iconUrl:o,isDisabled:n.createObservable(!0),isHidden:n.createPureComputed(function(){return 1!==s().state}),text:O.e,renderLabel:0}),new(n.managed(w.e))({text:a,action:new(n.managed(i.ItemPickerCompleteAction)),isPermanent:!0}),new(n.managed(w.e))({text:l,action:new(n.managed(i.ItemPickerCancelAction)),isPermanent:!0}));return n}return t})(b.e),_=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(p.e);n.commands.push(new(n.managed(l.e))({text:v.u,action:new(n.managed(r.ItemPickerSecureExperienceAction)),isPermanent:!0}),new(n.managed(l.e))({text:v.t,action:new(n.managed(r.ItemPickerCancelAction)),isPermanent:!0}));return n}return t})(b.e),D=n(187),P=n(34),H=n(25),B=n(703),j=n(41),F=n(376),I=n(174),q=n(52),R=q.t.isActivated("B6F9AD03-53D3-4DDC-AAA1-7A8051A8C3FE","3/16/2021","Include folders in extension filter when appropriate"),U=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.behavior;r._behavior=i;r._itemParentHelper=n.itemParentHelper;return r}t.prototype.getCanSelectItem=function(){for(var e=this,t=this._behavior,n=t.viewType,r=t.typeFilter,i=void 0===r?{filters:[]}:r,s=t.allowRootItem,o=void 0===s||s,u=[],a=function(e){if("string"==typeof e)"."===e[0]&&u.push(function(t){return Object(T.equalsCaseInsensitive)(t.extension,e)});else switch(e){case I.e.folder:R||1!==n&&u.push(function(e){return e.type===j.e.Folder});break;case I.e.photo:u.push(function(e){return!!e.photo&&!e.video});break;case I.e.video:u.push(function(e){return!!e.video});break;case I.e.media:u.push(function(e){return!!e.audio||!!e.photo||!!e.video});break;case I.e.document:u.push(function(e){return!!e.appMap});break;case I.e.audio:u.push(function(e){return!!e.audio})}},f=0,l=i.filters;f<l.length;f++){a(l[f])}var c=[];u.length&&c.push(function(e){return u.some(function(t){return t(e)})});switch(n){case 1:c.push(function(e){return e.type!==j.e.Folder});break;case 2:c.push(function(e){return e.type===j.e.Folder})}c.push(function(e){return!!e.itemId||!!e.isRootFolder});c.push(function(e){return!e.subsite});c.push(function(t){return!e.peekUnwrapObservable(e._itemParentHelper.getFacetedAncestorOrSelf(t,"mountPoint"))});return function(t){var n=e.peekUnwrapObservable(t);return!(n&&!o&&n.isRootFolder)&&(!n||c.every(function(e){return e(n)}))}};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{itemParentHelper:F.e});return t})(E.n),z=Object(N.o)("ItemPickerSelectionHelper",U),W=n(32),X=n(4),V=n(264),$=n(199),J=new $.e("ItemPickerCompleteAction",2),K=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ItemPicker.Complete";var i=r.resources.consume(p.n);r._itemPickerAgent=r.resources.consume(p.t);r._itemPickerStatus=r.resources.consume(p.r);r._mruRecentProvider=H.n.resolve(r.resources.consumeAsync(W.l.optional));r._canSelectItem=new(r.child(z))({behavior:i}).getCanSelectItem();var s=i.viewType,o=void 0===s?0:s,u=i.selectionMode,a=void 0===u?0:u,f=n.itemSelectionHelperType,l=void 0===f?r.resources.consume(B.e):f;r._itemSelectionHelper=new(r.scope.attached(l))({overrideItem:t.item,canFallback:1!==o,allowMultiSelect:1===a});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection()[0],t=this.unwrapObservable(e),n=this._itemPickerStatus().state;return!!this._itemPickerAgent&&!!t&&this._canSelectItem(e)&&(0===n||2===n)};t.prototype.recordRecentlyUsedForSelection=function(e){var t=this;return new H.n(function(n){var r=!1;if(e.length>0&&e[0].extension){var i=V.t(e[0].extension);if(("photo"===i||"video"===i)&&Object(X.isFeatureEnabled)(X.WriteMruSignalWhenMediaPicked)){r=!0;t._mruRecentProvider.then(function(r){if(r){var i=r.recordDocumentView(e[0]),s=new H.n(function(e){var n=t.async.setTimeout(function(){t.async.clearTimeout(n);e()},300)});H.n.race([i,s]).then(function(){n()},function(e){n()})}else n()})}}r||n()})};t.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemSelectionHelper.resolveSelection().then(function(e){return H.n.all([t.recordRecentlyUsedForSelection(e),t._itemPickerAgent.complete(e)])}).then(function(){t._itemPickerStatus({state:3});return{resultType:P.e.Success}},function(e){e[0];var n=e[1];t._itemPickerStatus({state:2,error:n});return{resultType:P.e.ExpectedFailure}})};t.prototype.getEngagement=function(){var t;return e.prototype.getEngagement.call(this).withPart(J,{extraData:{selectedCount:this._itemSelectionHelper.selection.peek().length,extension:null===(t=this.observables.peekUnwrap(this._itemSelectionHelper.firstItem))||void 0===t?void 0:t.extension}})};return t})(D.e),Q=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ItemPicker.Cancel";n._itemPickerAgent=n.resources.consume(p.t);n._itemPickerStatus=n.resources.consume(p.r);return n}t.prototype.onIsAvailable=function(){return!!this._itemPickerAgent};t.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemPickerAgent.cancel().then(function(){t._itemPickerStatus({state:4});return{resultType:P.e.Success}},function(e){t._itemPickerStatus({state:2,error:e});return H.n.wrapError(e)})};return t})(D.e),G=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ItemPicker.SwitchAccount";n._behavior=n.resources.consume(p.n);n._agent=n.resources.consume(p.t);return n}t.prototype.onExecute=function(e){return this._agent.switchAccount().then(function(){return H.n.wrap({resultType:P.e.Success})})};t.prototype.onIsAvailable=function(){var e=this._behavior.showSwitchAccount;return void 0!==e&&e};return t})(D.e),Y=n(1351),Z=n(1361),ee=n(23),te=n(147),ne=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.valueAccessor(),s=i.url,o=i.position,u=i.messenger,a=i.onMessage,f=i.onCancel;r._onMessage=a;r._onCancel=f;var l=n.window,c=void 0===l?window:l;r._window=c;var h=new te.e(s);r._targetOrigin=h.authority;a&&r.events.on(r._window,"message",r._onMessageReceived);var p=["scrollbars=yes"];o&&p.push("left="+o.x,"top="+o.y,"width="+o.width,"height="+o.height);r._childWindow=r._window.open(s,"_blank",p.join(", "));r.async.setInterval(r._checkWindow,100);r.addDisposable({dispose:function(){r._childWindow&&!r._childWindow.closed&&r._childWindow.close()}});u&&u(r._createMessenger());return r}t.prototype._checkWindow=function(){this._childWindow&&!this._childWindow.closed||this._onCancel&&this._onCancel()};t.prototype._onMessageReceived=function(e){if(e.source===this._childWindow&&e.origin===this._targetOrigin){var t=""+(e.data||"");this._onMessage&&this._onMessage(t)}};t.prototype._createMessenger=function(){var e=this;return{postMessage:function(t){e._childWindow.postMessage(t,e._targetOrigin)}}};t.supportsVirtualElements=!0;return t})(ee.t),re=n(333),ie=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemPickerDataSource=n.itemPickerDataSource;r._urlDataSource=n.urlDataSource;return r}t.prototype.getHandler=function(e){return this._itemPickerDataSource.getHandler(e)};t.prototype.getPivots=function(e){return this._itemPickerDataSource.getPivots(e)};t.prototype.getInitialViewParams=function(e){var t=e.behavior.typeFilter,n=void 0===t?{filters:[]}:t,r=e.viewParams;return{viewParams:Object(i.__assign)(Object(i.__assign)({},r),this._urlDataSource.saveItemTypeFilter(n))}};t.prototype.getItemFromPickerItem=function(e){var t={key:""};Object(re.default)(t,{itemId:e.id,graph:{itemId:e.id,driveId:re.optional(e.parentReference&&e.parentReference.driveId)},name:re.backup(e.name),extension:re.backup(e.extension),folder:re.optional(e.folder&&{})});Object(re.default)(t,this._itemPickerDataSource.getItemFromPickerItem(e));return t};t.prototype.getPickerItemFromItem=function(e,t){var n={id:e.itemId};Object(re.default)(n,{id:re.optional(e.graph&&e.graph.itemId),parentReference:re.optional(e.graph&&{driveId:e.graph.driveId}),folder:re.optional(e.folder&&{})});t.hostAuthenticationLevel>0&&Object(re.default)(n,{name:e.name,extension:e.extension});Object(re.default)(n,this._itemPickerDataSource.getPickerItemFromItem(e,t));return n};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{itemPickerDataSource:d.P,urlDataSource:d.ye});return t})(E.n),se=Object(N.s)("ItemPickerProvider",ie),oe=n(368),ue=n(9),ae=n(2259),fe=n(461);function le(e){var t=e.viewType,n=void 0===t?0:t,r=e.typeFilter,s=(void 0===r?{filters:[]}:r).filters;2===n&&(s=Object(i.__spreadArrays)(s,[I.e.folder]));return{filters:Object(fe.e)(s)}}var ce=["HTTP:","HTTPS:"];function he(e){void 0===e&&(e="");var t=e.toUpperCase();return ce.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0}function pe(e){void 0===e&&(e="");var t;if(e){for(var n=[],r=0,i="string"==typeof e?e.split(","):e;r<i.length;r++){var s=i[r];if("."===s.charAt(0)){var o=s.toLowerCase();n.indexOf(o)<0&&n.push(o)}else{var u=void 0;switch(s){case"folder":u=I.e.folder;break;case"photo":u=I.e.photo;break;case"video":u=I.e.video}u&&n.push(u)}}n.length&&n.push(I.e.folder);t={filters:n}}return t}var de=n(18);function ve(e){void 0===e&&(e="");var t;switch(e){case"readwrite":t=1;break;default:case"read":t=0}return t}function me(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readwrite";break;default:case 0:}return t}function ge(e){void 0===e&&(e="");var t;switch(e){case"multiple":t=1;break;default:case"single":t=0}return t}function ye(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:}return t}function be(e){void 0===e&&(e="");var t;switch(e){case"download":t=2;break;case"webView":t=0;break;case"share":t=3;break;case"all":t=4;break;default:case"web":t=1}return t}function we(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;default:case 1:}return t}function Ee(e){void 0===e&&(e="");var t;switch(e){case"files":t=1;break;case"folders":t=2;break;default:t=0}return t}function Se(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:}return t}function xe(e){void 0===e&&(e={filters:[]});for(var t,n=[],r=0,i=e.filters;r<i.length;r++){var s=i[r];if("string"==typeof s)n.push(s);else{var o=void 0;switch(s){case I.e.folder:o="folder";break;case I.e.photo:o="photo"}o&&n.push(o)}}n.length>1?t=n:n.length&&(t=n[0]);return t}var Te=n(48);function Ne(e){var t,n=e.picker||"";try{t=JSON.parse(n)}catch(e){}return t}function Ce(e){var t;return(t={}).picker=JSON.stringify(e),t}function ke(e,t){void 0===e&&(e={});void 0===t&&(t={});var n=t.itemTypeFilterFromViewParams,r=e.id,s=e.aid,o=e.a,u=e.v,a=e.s,f=e.l,l=e.f,c=e.o,h=e.sa,p=void 0===h||h,d=e.ss,v=void 0===d||d,m=e.sh,g=void 0!==m&&m,y=e.tf,b=void 0!==y&&y,w=e.cbt,E=e.fbt,S=e.cm,x=e.qos,T=e.sn,N=void 0===T||T,C=!(function(){try{return!!parent.document}catch(e){return!1}})()||N,k=Ee(u);return Object(i.__assign)(Object(i.__assign)({id:r,showActions:p,showBranding:C,showSwitchAccount:v,showSearch:g,enableFocusTrap:b,aadClientId:s,accessLevel:ve(o),viewType:k,selectionMode:ge(a),linkType:be(f),origin:c,typeFilter:le({typeFilter:pe(l)||!de.e.isActivated("7FC5B3FB-AF5D-4346-9F85-5A57C56A2908","6/24/2021","Fall back to filters from initial URL")&&n,viewType:k}),completeText:w,cancelText:E},(function(e){if(e){var t=void 0;switch(e){case"d":t=Te.s;break;case"cd":t=Te.n;break;case"t":t=Te.u}if(t)return{layoutType:t}}})(e.lt)||{}),{sdkVersion:"7.1",commandMode:S,qosData:x})}function Le(e){return{state:e.state,accessToken:e.access_token}}function Ae(e){var t=e.showActions,n=e.showBranding,r=e.showSwitchAccount,i=e.aadClientId,s=e.accessLevel,o=e.viewType,u=e.selectionMode,a=e.linkType,f=e.typeFilter,l=e.origin,c=e.id,h=e.commandMode,p=e.qosData,d={};Object(re.default)(d,{sa:re.optional(t),sn:re.optional(n),ss:re.optional(r),aid:re.optional(i),id:re.optional(c),o:re.optional(l),a:re.optional(me(s)),s:re.optional(ye(u)),v:re.optional(Se(o)),f:re.optional(xe(f)),l:re.optional(we(a)),lt:re.optional(Me(e.layoutType)),cm:re.optional("safe-write"!==h?h:void 0),qos:re.optional(p)});return d}function Oe(e){var t=e.msaClientId,n=e.state,r=e.accessToken,i={};n&&(i.state=n);t&&(i.client_id=t);r&&(i.access_token=r);return i}function Me(e){if(e)switch(e){case Te.s:return"d";case Te.n:return"cd";case Te.u:return"t"}}var _e={ONEDRIVE:"oneDrive",SITES:"sites",RECENT:"recent",SHARED:"shared",PHOTOS:"photos",BUSINESS:"business",CONSUMER:"consumer"};function De(e){return Object(i.__assign)(Object(i.__assign)({},(function(e){void 0===e&&(e={sdk:"7.2"});var t=e.ln,n=void 0===t||t;return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},ke(e)),(function(e){var t="string"==typeof e?e.split(","):e;if(t){for(var n={},r=0,i=t;r<i.length;r++){var s=(""+i[r]).trim().toUpperCase(),o=_e[s];o&&(n[o]=!0)}return{sourceTypes:n}}})(e.st)||{}),(function(e){if(e)return{entryLocation:Object(i.__assign)(Object(i.__assign)({},e.oneDrive?{oneDrive:Object(i.__assign)({},e.oneDrive.recent?{recent:{}}:{})}:{}),e.sharePoint?{sharePoint:{web:e.sharePoint.sitePath,list:e.sharePoint.listPath,folder:e.sharePoint.itemPath}}:{})}})(e.e)||{}),{showNavigation:n,showBranding:!1,sdkVersion:"7.2"})})(Ne(e))),Le(e))}function Pe(e){var t=(function(e){var t=Object(i.__assign)(Object(i.__assign)({},Ae(e)),{sdk:"7.2"});Object(re.default)(t,{ln:re.optional(e.showNavigation),st:re.optional(He(e.sourceTypes)),e:re.optional(Be(e.entryLocation)),sn:!1});return t})(e);return Object(i.__assign)(Object(i.__assign)({},Oe(e)),Ce(t))}function He(e){if(e){var t=[];for(var n in e)e[n]&&t.push(n);return 1===t.length?t[0]:t}}function Be(e){if(e)return Object(i.__assign)(Object(i.__assign)({},e.oneDrive?{oneDrive:Object(i.__assign)({},e.oneDrive.recent?{recent:{}}:{})}:{}),e.sharePoint?{sharePoint:{sitePath:e.sharePoint.web,listPath:e.sharePoint.list,itemPath:e.sharePoint.folder}}:{})}var je=n(20),Fe=n(166),Ie=(function(e){Object(i.__extends)(t,e);function t(t,n){var r,s,o,u;void 0===t&&(t={});void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({childWindow:ne});a._itemPickerProvider=a.resources.consume(se);var f=a.resources.consume(d.ye);a._messenger=a.createObservable();a._pickerId=oe.e.generate();var l=t.itemKey,c=t.agent,h=n.window,p=void 0===h?window:h;a._agent=c;var v={};Object(re.default)(v,t.behavior||{});Object(re.default)(v,{id:a._pickerId,showBranding:!0,showActions:!0,returnUrl:re.remove(),origin:new te.e(p.location.href).authority,state:re.remove()});var m,g,y=f.getDefaultClickUrl({key:l||f.getRootItemKey(),type:j.e.Folder},{page:ue.e.FilePicker,viewParams:{}}),b=f.qualifyUrl("#"+Object(je.n)(Object(i.__assign)(Object(i.__assign)({},Object(je.e)(y.substring(1))),"7.2"===v.sdkVersion?Pe(v):(function(e){var t=Ae(e);return Object(i.__assign)(Object(i.__assign)({},Oe(e)),Ce(t))})(v)))),w=p.screen,E=void 0===w?{availLeft:0,availTop:0,left:0,top:0,width:window.innerWidth,height:window.innerHeight}:w;m=void 0===(s=E.availLeft)?m=void 0===(r=E.left)?0:r:s,g=void 0===(u=E.availTop)?g=void 0===(o=E.top)?0:o:u;var S=Math.min(800,E.width-20),x=Math.min(600,E.height-20),T=(E.width-S)/2+m,N=(E.height-x)/2+g;a.childWindowOptions={url:b,position:new Fe.e(T,N,S,x),messenger:a._messenger,onMessage:function(e){return a._onMessage(e)},onCancel:function(){return a._agent.cancel().done()}};return a}t.prototype._onMessage=function(e){var t=this._messenger.peek();if(0===e.indexOf("[OneDrive-FromPicker]")){var n=JSON.parse(e.substring("[OneDrive-FromPicker]".length)),r=n.conversationId,i=n.pickerId;if(i!==this._pickerId)return;var s=void 0;switch(n.type){case"success":s=this._onSuccess(n);break;case"cancel":s=this._onCancel(n);break;case"switch":s=this._onSwitch(n);break;case"initialize":s=H.n.wrap({pickerId:i,conversationId:r,type:"activate"})}H.n.as(s).done(function(e){e&&t.postMessage("[OneDrive-ToPicker]"+JSON.stringify(e))})}};t.prototype._onSuccess=function(e){var t=this,n=e.items.map(function(e){return t._itemPickerProvider.getItemFromPickerItem(e)});return qe(this._agent.complete(n),e)};t.prototype._onCancel=function(e){return qe(this._agent.cancel(),e)};t.prototype._onSwitch=function(e){return qe(this._agent.switchAccount(),e)};return t})(s.t);function qe(e,t){return e.then(function(){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"acknowledge"}},function(e){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"error",error:{message:e.message}}})}var Re=Object(r.e)({tagName:"od-file-picker-remote-host",template:"\x3c!--ko childWindow:childWindowOptions--\x3e\x3c!--/ko--\x3e",viewModel:Ie,synchronous:!0}),Ue=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.filePickerRemoteHostTagName=Re.tagName;n._agent=n.resources.consume(p.t);n._behavior=n.resources.consume(p.n);n._status=n.resources.consume(p.r);n.showFilePicker=n.createObservable(!0);n.filePickerRemoteHostParams={agent:{initialize:function(){return n._agent.initialize()},complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()},switchAccount:function(){return n._switchAccount()},getApplication:function(){return n._agent.getApplication()}},behavior:n._behavior};return n}t.prototype._complete=function(e){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.complete(e).then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return H.n.wrapError(e)})};t.prototype._cancel=function(){var e=this;this._status({state:1});this.showFilePicker(!1);return this._agent.cancel().then(function(){e._status({state:4});e.action.cancel()},function(t){e._status({state:2,error:t});return H.n.wrapError(t)})};t.prototype._switchAccount=function(){var e=this;this._status({state:1});this.showFilePicker(!1);return this._agent.switchAccount().then(function(){e._status({state:3});e.action.complete()},function(t){e._status({state:2,error:t});return H.n.wrapError(t)})};return t})(Z.e),ze=Object(r.e)({tagName:"od-item-picker-secure-experience-executor",template:"\x3c!--ko if:showFilePicker--\x3e\x3c!--ko component:{name:filePickerRemoteHostTagName,params:filePickerRemoteHostParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModel:Ue,synchronous:!0}),We=((function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createObservable({isAvailable:!0});return n}})(E.n),Object(Y.e)({name:"ItemPickerSecureExperience",source:{component:ze}})),Xe=function(){this.ItemPickerCompleteAction=K;this.ItemPickerCancelAction=Q;this.ItemPickerSwitchAccountAction=G;this.ItemPickerSecureExperienceAction=We},Ve=n(169),$e=n(278),Je=n(468),Ke=n(2260),Qe=n(16),Ge=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(p.n),i=r.completeText,s=void 0===i?2===r.viewType&&1===r.accessLevel?v.r:v.n:i,o=r.cancelText,u=void 0===o?v.t:o,a=n.resources.consume(p.e);n.commands.push(new(n.managed(w.e))({text:s,action:new(n.managed(a.ItemPickerCompleteAction)),icon:new Qe.e("CheckMark"),renderLabel:2}),new(n.managed(w.e))({text:u,action:new(n.managed(a.ItemPickerCancelAction)),icon:new Qe.e("Cancel"),location:12,renderLabel:0}));return n}return t})(b.e),Ye=n(471),Ze=(n(539),n(83)),et=n(66),tt=n(72),nt=n(123),rt=n(107),it=n(93),st=n(65),ot=n(53),ut=n(406),at=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=Ze.e.tagName;n.buttonBarTagName=u.e.tagName;n.closeLabel=ut.e;n.addBindingHandlers({dismiss:a.e,element:st.e,host:y.e,interactionScope:et.e,focusTrap:it.e,recoverFocus:rt.e,preserveFocus:nt.e,scrollContainer:tt.e});var r=t.size,i=void 0===r?"Small":r,s=t.title,o=void 0===s?"":s,f=t.onClose,l=t.showCloseButton,c=void 0===l||l,h=t.commandSet;n._size=i;n._onClose=f;n.contentElement=n.createObservable();n.title=n.wrapObservable(o);n.showCloseButton=n.createObservable(!!n._onClose&&c);n.showTitle=n.createPureComputed(n._computeShowTitle);n.widthClass=n.createPureComputed(n._computeWidthClass);n.showActions=n.createObservable(!!h);n.buttonBarParams={commandSet:h};return n}t.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype._computeWidthClass=function(){return ot.t.determineCssClass(this._size)};t.prototype._computeShowTitle=function(){return!!this.title()};return t})(s.t),ft=Object(r.e)({tagName:"od-dialog-overlay-2",template:'\x3c!--ko component:{name:overlayTagName,params:{animation:{beforeRemove:500},alignToParent:false}}--\x3e<div class="od-Dialog" data-bind="css:{\'od-Dialog--close\':showCloseButton},focusTrap:{}"><div class="ms-ModalOverlay od-DialogOverlay"></div><div class="od-Dialog-main od-Dialog-main--dialog od-Dialog-main--visible" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},scrollContainer,dismiss:{close:$component.onDismiss.bind($component)},class:\'od-Dialog-main--\'+$component.widthClass(),attr:{\'aria-label\':title},element:$component.contentElement">\x3c!--ko if:showTitle--\x3e<div class="od-Dialog-header od-Dialog-header--s"><div class="od-Dialog-title" data-bind="text:title"></div></div>\x3c!--/ko--\x3e<div class="od-Dialog-inner"><div class="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:showActions--\x3e<div class="od-Dialog-actions"><div class="od-Dialog-actionsRight" data-bind="component:{name:buttonBarTagName,params:buttonBarParams}"></div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:$component.onClose.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e',viewModel:at,synchronous:!0}),lt=n(496),ct=n(470),ht=n(22),pt=n(27),dt=n(261);var vt=n(2404),mt=n(2630),gt=n(231),yt=n(61),bt=n(3),wt=new bt.t({name:"ItemsPicker.key",loader:new N.t(function(){return n.ee([161],3518).then(function(e){return e.knockoutResourceKey.local})})}),Et=n(26),St=n(820),xt=n(830),Tt=n(1249),Nt=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return Et.createElement(Et.Fragment,null,this.props.children)};t.contextTypes=Object(i.__assign)({},St.e);return t})(Et.PureComponent),Ct=Object(xt.e)("ItemsPickerPlaceholder",Nt,{}),kt=Object(Tt.e)(Ct,{automationName:"ms-items-picker-placeholder",name:"ItemsPickerPlaceholder.knockout"}),Lt=n(102),At=n(1592),Ot=n(1705);function Mt(e){var t=e.typeFilter;if(t){for(var n=[],r=t.filters,i=0,s=void 0===r?[]:r;i<s.length;i++){var o=s[i];if("string"==typeof o)n.push(Object(Ot.t)(o));else switch(o){case I.e.folder:n.push(At.e);break;case I.e.photo:n.push(At.o);break;case I.e.video:n.push(At.u)}}return n}}var _t=n(101),Dt=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r.itemPickerHeaderTagName=g.tagName;r.buttonBarTagName=u.e.tagName;r.topBarTagName=Ye.e.tagName;r.dialogOverlayTagName=ft.tagName;r.leftNavExpanderTagName=ct.e.tagName;r.overlayTagName=Ze.e.tagName;r.secureExperienceWarningText=v.a;r.addBindingHandlers({host:y.e,control:pt.n,dismiss:a.e,focusTrap:it.e,recoverFocus:rt.e,preserveFocus:nt.e});var i=t.behavior,s=void 0===i?{}:i,o=t.commandSet,f=t.search,l=n.topCommandSetType,c=void 0===l?Ge:l,h=n.inlineCommandSetType,d=void 0===h?M:h,m=n.secureExperienceCommandSetType,b=void 0===m?_:m;r._useItemsScope=r.observables.wrap(t.useItemsScope);var w=s.showActions,E=void 0!==w&&w,S=s.showBranding,T=void 0!==S&&S,N=s.showNavigation,C=void 0!==N&&N,k=s.enableFocusTrap,A=void 0!==k&&k,O=s.showSearch,D=void 0!==O&&O,H=s.typeFilter,B=s.sourceTypes,j=r,F=j.resources,q=j.observables;r._isNavigationEnabled=C;F.expose(p.e,new(r.managed(Xe)));var R=r.scope.attach(new Pt({agent:t.agent}));F.expose(p.t,R);r._status=F.expose(p.r,q.create({state:0}));F.expose(p.n,s);F.expose(vt.e,H);F.expose(mt.e,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){if(!t)return e;if(!e)return t;var n={};for(var r in t)e[r]&&t[r]&&(n[r]=!0);return n},void 0)})(B,(function(e){void 0===e&&(e={filters:[]});var t=e.filters;if(t.length){for(var n={},r=Object(X.isFeatureEnabled)(X.EnableRecentForMediaTypeFilters),i=0,s=t;i<s.length;i++){var o=s[i];if("string"==typeof o){var u=Object(V.t)(o);if(dt.t[u]){n.recent=!0;n.shared=!0}else switch(u){case"photo":case"video":n.photos=!0;n.shared=!0;r&&(n.recent=!0)}}else switch(o){case I.e.media:case I.e.photo:case I.e.video:n.photos=!0;n.shared=!0;r&&(n.recent=!0);break;case I.e.audio:n.shared=!0;break;default:case I.e.folder:n.oneDrive=!0;n.sites=!0;n.shared=!0;n.business=!0;n.consumer=!0}}return n}})(H)));r._responsiveUI=F.consume(ot.n);r._rumone=F.consume(Ve.e.optional);r._statusHelper=F.consume(L);r._itemsSelection=F.consume(x.C);q.subscribe(r._itemsSelection.selection,r._onSelectionChanged);r._engagement=r.resources.consume(yt.e);r.itemPickerHeaderParams={};r._itemSelectionHelperTypeKey=r._getItemSelectionHelperTypeKey();if(o||!E){var U=[];E||U.push(r._getCommandSet(c));o&&U.push(o);r.commandBarSpecification=r._getCommandBarSpecification(new(r.managed(Ke.e))({commandSets:U}))}if(E){var z=r._getCommandSet(d);r.buttonBarParams={commandSet:z}}r.showContent=q.create(!1);r.showSecureExperienceDialog=q.create(!1);r.secureExperienceErrorText=q.pureCompute(r._computeSecureExperienceErrorText);r.secureExperienceErrorStyle=q.pureCompute(r._computeSecureExperienceErrorStyle);r.showSearch=D&&!!f;r.showBranding=T;r.showActions=E;r.showCommandBar=!!o;r.isFocusTrapEnabled=q.create(A);r.secureExperienceCommandSet=new(r.managed(b));r.hostBindingOptions={data:{status:r._status}};r.showLeftPane=q.pureCompute(r._computeShowLeftPane);r.showLeftPaneExpander=q.pureCompute(r._computeShowLeftPaneExpander);var W=r.isLeftPaneOpen=q.create(!1);r.leftPaneSpecification=Object(pt.r)(lt.e,{isLeftNavVisible:q.pureCompute(function(){return r.showLeftPane()||W()}),overrideResponsiveBehavior:!0});r.searchSpecification=f;F.expose(ht.e.leftNav.isLeftNavUserExpanded,W);F.expose(ht.e.leftNav.toggleIsLeftNavUserExpanded,function(){W(!W.peek());return!1});r.pickerSpecification=r._getPickerSpecification({behavior:s});var $=new gt.e({name:"ItemPicker.initialize"});r._engagement.logData({name:"ItemPicker.Initialize",isIntentional:!1});R.initialize().done(function(){$.end({resultType:P.e.Success});r.showContent(!0)},function(e){$.end({resultType:P.e.Failure,error:e&&e.message,extraData:{pickerOrigin:""+(s.origin||"")}});r._engagement.logData({name:"ItemPicker.SecureExperience.View",isIntentional:!1});r.showSecureExperienceDialog(!0)});return r}t.prototype._onSelectionChanged=function(){this._status({state:0})};t.prototype._computeSecureExperienceErrorText=function(){var e=this._statusHelper.commandStatus();return e&&e.text||""};t.prototype._computeSecureExperienceErrorStyle=function(){var e=this._statusHelper.commandStatus();return S.e[e&&e.state||S.e.initialized]};t.prototype._computeShowLeftPane=function(){var e=this._responsiveUI;return this._isNavigationEnabled&&e.compareSize(e.formFactorSize(),"Large")>0};t.prototype._computeShowLeftPaneExpander=function(){return this._isNavigationEnabled&&!this.showLeftPane()};t.prototype._getCommandBarSpecification=function(e){var t=this,n=Object(pt.r)($e.e,{commandSet:e,isMobile:!1}),r={props:{handleRenderComplete:function(e,n){var r=t._rumone;r&&r.logRUMOneForDeferredControl("TopLevelCommandBar",e);n.unblockItemPageRender()}},useDOMContext:!0},i=Object(pt.r)(Je.e,r);return this.observables.pureCompute(function(){return t._useItemsScope()?i:n})};t.prototype._getPickerSpecification=function(e){var t=e.behavior,n={props:{selectionMode:0===t.selectionMode?"single":"multiple",itemMode:2===t.viewType?"folders":1===t.viewType?"files":"all",filters:Mt(t),commandMode:t.commandMode},rootProps:{className:"od-ItemPicker-picker"}},r=Object(pt.r)(wt,n),i=Object(pt.r)(kt,n);return this.observables.pureCompute(function(){return Object(X.isFeatureEnabled)(X.UseItemsScopeInPicker)?r:i})};t.prototype._getCommandSet=function(e){var t,n=this;return this.observables.pureCompute(function(){var r=n._useItemsScope(),i=r&&n._itemSelectionHelperTypeKey();return n.observables.ignore(function(){t&&t.dispose();t=n.scope.attach(new Lt.e);var s;if(r){if(!i)return t.attach(new(n.resources.injected(b.e)));(s=t.attach(new bt.n(n.resources))).exposeFactory(B.e,new N.e(i))}else s=n.resources;return t.attach(new(s.injected(e)))})})};t.prototype._getItemSelectionHelperTypeKey=function(){var e=this.observables.create(),t=!1;return this.observables.pureCompute(function(){if(!t){t=!0;n.ee([78],1553).then(function(t){e(t.typeResourceKey)})}return e()})};return t})(s.t),Pt=(function(){function e(e){this._agent=e.agent}e.prototype.initialize=function(){var e=this;this._timeToFile||(this._timeToFile=new gt.e({name:"ItemPicker.pickFiles"}));return H.n.resolve().then(function(){if(e._agent)return e._agent.initialize()})};e.prototype.complete=function(e){var t,n=this;if(this._timeToFile){this._timeToFile.end({resultType:P.e.Success,resultCode:"Picked",extraData:{selectedCount:e.length,extension:null===(t=e[0])||void 0===t?void 0:t.extension}});this._timeToFile=void 0}return H.n.resolve().then(function(){if(n._agent)return n._agent.complete(e).then(function(){},function(e){return H.n.reject(e)});throw new _t.e({code:"SwitchAccountNotImplemented",isExpected:!0})})};e.prototype.cancel=function(){var e=this;if(this._timeToFile){this._timeToFile.end({resultType:P.e.ExpectedFailure,resultCode:"Canceled"});this._timeToFile=void 0}return H.n.resolve().then(function(){if(e._agent)return e._agent.cancel();throw new _t.e({code:"CancelNotImplemented",isExpected:!0})})};e.prototype.switchAccount=function(){var e=this;return H.n.resolve().then(function(){if(e._agent)return e._agent.switchAccount();throw new _t.e({code:"SwitchAccountNotImplemented",isExpected:!0})})};e.prototype.getApplication=function(){var e=this;return H.n.resolve().then(function(){if(e._agent)return e._agent.getApplication()})};e.prototype.dispose=function(){if(this._timeToFile){this._timeToFile.end({resultType:P.e.ExpectedFailure,resultCode:"Disposed"});this._timeToFile=void 0}};return e})(),Ht=(r.e({tagName:"od-item-picker",template:'<div class="od-ItemPicker" data-bind="css:{\'od-ItemPicker--hasBranding\':showBranding,\'od-ItemPicker--hasActions\':showActions,\'od-ItemPicker--hasCommandBar\':showCommandBar,\'od-ItemPicker--hasLeftPane\':showLeftPane,\'od-ItemPicker--leftPaneIsOpen\':showLeftPane()&&isLeftPaneOpen(),\'od-ItemPicker--hasSearch\':showSearch},focusTrap:{isEnabled:isFocusTrapEnabled}">\x3c!--ko if:showSecureExperienceDialog--\x3e\x3c!--ko component:{name:dialogOverlayTagName,params:{commandSet:secureExperienceCommandSet}}--\x3e<p data-bind="text:secureExperienceWarningText"></p>\x3c!--ko if:secureExperienceErrorText--\x3e<p data-bind="text:secureExperienceErrorText,class:\'od-ItemPicker-secureExperienceStatus--\'+secureExperienceErrorStyle()"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showBranding--\x3e<div class="od-ItemPicker-branding" data-bind="component:{name:itemPickerHeaderTagName,params:itemPickerHeaderParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showContent--\x3e<div class="od-ItemPicker-pickerWrapper" data-bind="control:pickerSpecification">\x3c!--ko if:showLeftPane()--\x3e<div class="od-ItemPicker-leftPane" data-bind="control:leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if:!showLeftPane()&&isLeftPaneOpen()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:true,animation:{afterAdd:1,beforeRemove:500}}}--\x3e<div class="od-ItemPicker-leftPaneModal ms-ModalOverlay"></div>\x3c!--ko focusTrap:{}--\x3e<div class="od-ItemPicker-leftPaneOverlay" tabindex="-1" data-bind="dismiss:{isOpen:isLeftPaneOpen},recoverFocus:{isEnabled:$host.isOpen},preserveFocus:{},control:leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="od-ItemPicker-main">\x3c!--ko if:showSearch--\x3e<div class="od-ItemPicker-search" data-bind="control:searchSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if:showCommandBar--\x3e<div class="od-ItemPicker-topBar" data-bind="component:{name:topBarTagName,params:{}}">\x3c!--ko if:showLeftPaneExpander--\x3e<div class="od-ItemPicker-leftNavExpander od-TopBar-item od-TopBar-leftNavExpander" data-bind="component:{name:leftNavExpanderTagName}"></div>\x3c!--/ko--\x3e<div class="od-ItemPicker-commandBar od-TopBar-item od-TopBar-commandBar" data-bind="control:commandBarSpecification"></div></div>\x3c!--/ko--\x3e<div class="od-ItemPicker-selector" data-bind="host:hostBindingOptions"></div>\x3c!--ko if:showActions--\x3e<div class="od-ItemPicker-actions" data-bind="component:{name:buttonBarTagName,params:buttonBarParams}"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>',viewModel:Dt,synchronous:!0}),n(1704),n(450)),Bt=n(472),jt=n(2405),Ft=n(1),It=n(6),qt=n(409),Rt=n(223),Ut=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(x.e);n._layoutType=n.resources.consume(ht.o.layoutType);var i=t.isSelectionMode,s=void 0===i?n.createObservable(!1):i,o=t.location,u=void 0===o?4:o,a=t.allowAlbumView,f=void 0!==a&&a,l=t.clearContextualFilter,c=void 0!==l&&l;n._shouldClearContextualFilter=c;var h=new(n.managed(Rt.e))({showLabels:null});n._viewToggleIcon=n.createPureComputed(function(){return h.computeViewSelectorIcon()},{deferEvaluation:!0});n._viewSelectorAriaLabel=n.createPureComputed(n._computeViewSelectorAriaLabel);var p=[new(n.managed(w.e))({text:It.ViewList,tooltip:It.ViewListCommandTooltip,icon:new Qe.e(Rt.e.detailsIcon),renderLabel:0,isToggleable:!0,isHidden:s,hasIconOnly:!0,action:new(n.managed(r.ToggleListLayoutAction))({layoutType:Te.s,clearContextualFilter:n._shouldClearContextualFilter}),automationId:"switchLayout",engagementName:"ViewList"}),new(n.managed(w.e))({text:It.ViewCompactList,tooltip:It.ViewCompactListCommandTooltip,icon:new Qe.e(Rt.e.compactDetailsIcon),renderLabel:0,isToggleable:!0,isHidden:s,hasIconOnly:!0,action:new(n.managed(r.ToggleListLayoutAction))({layoutType:Te.n,clearContextualFilter:n._shouldClearContextualFilter}),engagementName:"ViewCompactList"}),new(n.managed(w.e))({text:It.ViewGrid,tooltip:It.ViewGridCommandTooltip,icon:new Qe.e(Rt.e.gridIcon),renderLabel:0,isToggleable:!0,isHidden:s,hasIconOnly:!0,action:new(n.managed(r.ToggleListLayoutAction))({layoutType:Te.u,clearContextualFilter:n._shouldClearContextualFilter}),engagementName:"ViewGrid"})];f&&p.push(new(n.managed(w.e))({text:It.ViewLargeGrid,renderLabel:0,icon:new Qe.e(Rt.e.singleAlbumIcon),isToggleable:!0,isHidden:s,hasIconOnly:!0,action:new(n.managed(r.ToggleListLayoutAction))({layoutType:Te.l,clearContextualFilter:n._shouldClearContextualFilter}),engagementName:"ViewLargeGrid"}));var d=new(n.managed(w.e))({tooltip:It.ViewsCommandTooltip,accessibleLabel:n._viewSelectorAriaLabel,renderLabel:0,icon:n._viewToggleIcon,location:u,isHidden:s,hasIconOnly:!0,collapseSingleChildCommands:!0,requiredChildren:2,children:Ft.observableArray(p)});n.command=d;return n}t.prototype._computeViewSelectorAriaLabel=function(){var e,t=this._layoutType();e=t===Te.l?It.ViewAlbumView:t===Te.u||t===Te.r?It.ViewGrid:t===Te.n?It.ViewCompactList:It.ViewList;return T.format(It.ViewsCommandAriaLabel,e,"","")};return t})(E.n),zt=n(125),Wt=(function(e){Object(i.__extends)(t,e);function t(n){var r;void 0===n&&(n={});var i=e.call(this,n)||this;i._itemPickerProvider=i.resources.consume(se);i._viewParams=i.resources.consume(x.H);i._selection=i.resources.consume(x.C);i._isSelectionModeOn=i.createPureComputed(i._computeSelectionModeOn);var s=n.behavior,o=void 0===s?i.resources.consume(p.n):s;i._behavior=o;i._actionMap=i.resources.consume(x.e);i._initializePivots(i._behavior);i._navigationAction=new(i.managed(i._actionMap.NavigationAction))({url:i.createPureComputed(i._computeInitialUrl),ignoreHistory:!0});var u=new(i.managed(qt.e))({renderLabel:1}).command,a=o.showCommandBar,f=void 0===a||a;(r=i.commands).push.apply(r,i._pivots);f&&i.commands.push(new(i.managed(w.e))({location:0,action:new(i.managed(i._actionMap.OpenAction))({openRelation:3}),keys:["AltUp"]}),new(i.managed(w.e))({text:It.CreateFolderCommand,icon:new Qe.e("Folder"),action:new(i.managed(i._actionMap.CreateFolderAction)),automationId:"createFolder",isHidden:i._isSelectionModeOn,engagementName:"NewFolder"+t.sourceNameEngagement}),new(i.managed(w.e))({text:It.Upload,tooltip:It.UploadCommandTooltip,icon:new Qe.e("Upload"),requiredChildren:1,automationId:"upload",isHidden:i._isSelectionModeOn,engagementName:"Upload"+t.sourceNameEngagement,children:Ft.observableArray([new(i.managed(w.e))({text:It.UploadFile,collapsedText:i.createObservable(It.Upload),action:new(i.managed(i._actionMap.UploadAction))({uploadProcessorType:zt.e.Html5file}),automationId:"uploadFiles",engagementName:"UploadFiles"+t.sourceNameEngagement}),new(i.managed(w.e))({text:It.UploadFolder,action:new(i.managed(i._actionMap.UploadAction))({uploadProcessorType:zt.e.Folder}),automationId:"uploadFolder",engagementName:"UploadFolder"+t.sourceNameEngagement})])}),new(i.managed(w.e))({text:It.selectItems,renderLabel:2,icon:new Qe.e("CheckboxComposite"),action:new(i.managed(i._actionMap.ToggleSelectionModeAction))}),u,new(i.managed(Ut))({isSelectionMode:i._isSelectionModeOn}).command,new(i.managed(w.e))({location:0,action:new(i.managed(i._actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}));return i}t.prototype.navigateToPivot=function(){this._navigationAction.execute(null).done()};t.prototype._initializePivots=function(e){var t=this;this._pivots=[];if(!e.showNavigation){var n=this._itemPickerProvider.getPivots({behavior:e,viewParams:this._viewParams.peek()}).pivots;if(1===n.length)return;for(var r=function(e){return t.createPureComputed(function(){return e(t._viewParams())})},i=0;i<n.length;i++){var s=n[i],o=s.item,u=r(s.isActive),a=this.createObservable(o);this._pivots.push(new(this.managed(w.e))({text:o.displayName,isPermanent:!0,action:new(this.managed(this._actionMap.DefaultClickAction))({item:a,sourceEngagement:"FilePicker.Pivot.Click"}),isCurrentView:u,isLastPivot:i===n.length-1}))}}};t.prototype._computeInitialUrl=function(){var e=this._itemPickerProvider.getInitialViewParams({behavior:this._behavior,viewParams:this._viewParams.peek()}).viewParams;return"#"+je.n(e)};t.prototype._computeSelectionModeOn=function(){return this._selection&&this._selection.selection().length>0};t.sourceNameEngagement=".InFilePickerCommandBar";return t})(b.e),Xt=n(2005),Vt=n(8),$t=new bt.t({name:"PhotosRootItemContent.key",loader:new N.t(function(){return n.ee([159],2805).then(function(e){return e.resourceKey.local})})}),Jt=n(2406),Kt=n(2362),Qt=n(240),Gt=new $.e("FilePicker",3,{getEngagementData:function(e){var t=e.behavior;return{scenario:"FilePicker",extraData:Object(i.__assign)({clientId:t.aadClientId||t.msaClientId,isFilePicker:1,pickerOrigin:""+(t.origin||""),pickerHostname:""+new Qt.e(t.origin||"").domain,pickerSdk:t.sdkVersion,pickerViewType:tn(t.viewType),pickerLinkType:Zt(t.linkType),pickerAccessLevel:Yt(t.accessLevel),pickerSelectionMode:en(t.selectionMode)},t.qosData)}}});function Yt(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readWrite";break;default:case 0:t="readOnly"}return t}function Zt(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;case 4:t="all";break;case 3:t="share";break;default:case 1:t="web"}return t}function en(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:t="single"}return t}function tn(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:t="all"}return t}var nn=n(1300),rn=n(1831),sn=n(1129),on=n(1589),un=(function(){function e(e,t){this._behavior=e.behavior;this._itemCommandProvider=t.itemCommandProvider}e.prototype.getCommand=function(e,t){var n,r=this._behavior,i=r.viewType,s=r.commandMode;switch(t){case rn.e:case sn.n:n="none"!==s;break;case sn.u:n=!0;break;case on.t:n=2!==i&&"none"!==s;break;default:n=!1}if(n)return this._itemCommandProvider.getCommand(e,t)};e.dependencies={itemCommandProvider:nn.e};return e})(),an=Object(N.o)("FilePickerItemCommandProvider",un),fn=n(464),ln=n(120),cn=n(396),hn=n(453),pn=n(420),dn=n(427),vn=n(2108),mn=n(95),gn=n(77),yn=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r.overlayHostTagName=hn.e.tagName;r.dialogHostTagName=pn.e.tagName;r.panelHostTagName=dn.e.tagName;r.addBindingHandlers({scrollContainer:tt.e,host:y.e,hideWhenInactive:fn.e});var i=r.resources;i.bind(cn.e);i.bind(ln.e);var s=t.behavior,o=t.commandSet,u=t.agent,a=t.shouldHostOverlays,f=void 0===a||a;r._behavior=s;var l=s.layoutType;r._photosItemsScopeItemProps=r.createPureComputed(r._computePhotosItemsScopeProps);r._useAllPhotosItemsScopePicker=i.consume(gn.t);i.expose($.t,i.consume($.t).withPart(Gt,{behavior:s}));r.shouldHostOverlays=f;var c=new(i.consume(an))({behavior:s});i.expose(nn.e,c);var h=new(r.managed(Wt))({behavior:s}),p=[];p.push(h);o&&p.push(o);r.itemPickerParams={behavior:s,agent:u,commandSet:new(r.managed(Ke.e))({commandSets:p})};h.navigateToPivot();if(l){var d=new(r.managed(vn.e))({layoutType:l});d.isAvailable.peek()&&d.execute(void 0)}return r}t.prototype.computeCurrentPageName=function(){var e;switch(this.item.peek().displayType){case Vt.e.AllMyPhotos:e="Photos";break;default:e="Files"}return"FilePicker-"+e};t.prototype.computeContentControl=function(){var t=e.prototype.computeContentControl.call(this),n=this.item();if(t)return t;var r=this.urlDataSource.getKeyParams(n.key);if(this.urlDataSource.getQueryType(r)===Vt.e.AllMyPhotos&&this._useAllPhotosItemsScopePicker)return Object(pt.r)(Jt.e,this._photosItemsScopeItemProps());var i=this.getContentControlParams();switch(n.displayType){case Vt.e.AllMyPhotos:return Object(pt.r)($t,i);default:return Object(pt.r)(Kt.resourceKey,i)}};t.prototype.computeCreateDataManager=function(){var e,t=this.viewParams();switch(this.urlDataSource.getQueryType(t)){case Vt.e.AllMyPhotos:e=this._createPhotosDataManager;break;default:e=this._createFilesDataManager}return e};t.prototype.getSelectionOptions=function(e){var t=e.behavior,n=t.selectionMode,r=t.maximumSelectedCount,i=e.behavior,s=new(this.child(z))({behavior:i});return{mode:Xt.a[n],maximumSelectedCount:r,canSelectItem:s.getCanSelectItem()}};t.prototype._createFilesDataManager=function(){return new(this.managed(Bt.e))({itemResultSetOptions:this._behavior.itemResultSetOptions})};t.prototype._createPhotosDataManager=function(){return new(this.managed(jt.e))({itemResultSetOptions:this._behavior.itemResultSetOptions})};t.prototype._computePhotosItemsScopeProps=function(){var e=this;return{props:{layoutType:Te.t,isMobile:this.platform.isMobile,child:function(t){return e.child(t)},photoType:mn.e.AllMyPhotos,isInFilePicker:!0}}};return t})(Ht.e),bn=r.e({tagName:"od-filepicker",template:'<div class="od-FilePicker"><div class="od-FilePicker-picker" data-bind="component:{name:\'od-item-picker\',params:itemPickerParams},hideWhenInactive">\x3c!--ko if:isRetrievingData--\x3e<div class="od-FilePicker-loadingDiv" data-bind="component:{name:\'ms-progressSpinnerFlat\'}"></div>\x3c!--/ko--\x3e<div class="od-FilePicker-content" data-bind="scrollContainer"><div class="od-FilePicker-innerContent">\x3c!--ko host:{data:$host}--\x3e\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e</div></div></div>\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko if:shouldHostOverlays--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',viewModel:yn,synchronous:!0}),wn=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._applicationDataSource=n.applicationDataSource;var i=n.itemPickerProvider,s=n.viewParams.peek(),o=i.getHandler({viewParams:s}).handlerTypeKey,u=new(r.child(o))({viewParams:s,getApplication:function(){return r._getApplication()}});r._behavior=u.getBehavior();r._agent={initialize:function(){return u.initialize()},getApplication:function(){return r._getApplication()},complete:function(e){return u.complete(e)},cancel:function(){return u.cancel()},switchAccount:function(){return u.switchAccount()}};return r}t.prototype.getAgent=function(){return this._agent};t.prototype.getBehavior=function(){return this._behavior};t.prototype._getApplication=function(){var e,t=this._behavior.msaClientId;e=this._applicationDataSource&&t?this._applicationDataSource.getApplicationDetails({clientId:t}):H.n.wrap();this._getApplication=function(){return e};return e};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{applicationDataSource:d.n.optional,viewParams:x.H,itemPickerProvider:se});return t})(E.n),En=Object(N.o)("FilePickerAgentHelper",wn),Sn=n(135),xn=n(149),Tn=n(845),Nn=n(527),Cn=n(75),kn=n(50);function Ln(e){var t;switch(e){case"multi":t=1;break;default:case"single":t=0}return t}var An=n(380),On=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.currentWindow,s=void 0===i?window:i;r._currentWindow=s;return r}t.prototype.validateExperience=function(e){void 0===e&&(e={authenticationLevel:0,reason:"unknown"});var t=new gt.e({name:"ItemPickerSecureExperienceHelper.validateExperience"}),n=this._currentWindow;if(n.self===n.top){t.end({resultType:P.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"self"}});return H.n.wrap()}var r=n.parent;if(r)try{if(r.location.href){t.end({resultType:P.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"sameDomain"}});return H.n.wrap()}}catch(e){}if(e.authenticationLevel>0){t.end({resultType:P.e.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}});return H.n.wrap()}t.end({resultType:"origin"===e.reason?P.e.ExpectedFailure:P.e.Failure,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}});return this._createInsecureError()};t.prototype._createInsecureError=function(){return H.n.wrapError(new Error("The picker is not being loaded in a secure context."))};t.dependencies=Object(i.__assign)({},E.n.dependencies);return t})(E.n),Mn=Object(N.o)("SecureExperienceHelper",On),_n=["DOCS.COM","ONEDRIVE.COM","LIVE.COM","LIVE-INT.COM","OFFICE.COM","LIVE-TST.COM","OFFICEAPPS.LIVE.COM","GOV.ONLINE.OFFICE365.US","DOD.ONLINE.OFFICE365.US","OFFICEAPPS-DF.LIVE.COM","ONLINE.OFFICE.DE","PARTNER.OFFICEWEBAPPS.CN"];function Dn(e){for(var t=new te.e(e).domain.toUpperCase(),n=0,r=_n;n<r.length;n++){var i=r[n],s="."+i;if(i===t||t.indexOf(s,t.length-s.length)>-1)return!0}return!1}var Pn=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this,i=t.viewParams;r._liveSdkScriptSource=i.livesdk;r._urlType=i.auth===kn.t.skyDrivePickerOAuth?2:1;var s=n.getSkyDrivePicker,o=void 0===s?Hn:s,u=n.DataRequest,a=void 0===u?An.e:u;r._getSkyDrivePicker=o;var f=r._behavior=(function(e){var t=(function(e){var t,n;switch(e.v){case"1":case"FolderPickerView":t=2;n=1}return{viewType:t,accessLevel:n}})(e),n=t.viewType,r=t.accessLevel,i=e.domain,s={showActions:!0,showBranding:!0,showSwitchAccount:!1,viewType:n,selectionMode:Ln(e.select),accessLevel:r,typeFilter:le({viewType:n}),sdkVersion:"5.0"};i&&(s.origin="https://"+i);return s})(i);r._validateSignal=r._getValidateSignal();var l=r.scope;r._dataRequest=new(l.attached(a));r._secureExperienceHelper=new(l.attached(n.secureExperienceHelperType))({behavior:f});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._loadSkyDrivePicker().then(function(){e.async.setTimeout(function(){e._validateSignal.complete({authenticationLevel:0,reason:"timeout"})},Xt.i);return e._validateSignal.getPromise()}).then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){var t=this,n=H.n.all(e.map(function(e){return t._getSkyApiItem(e)}));return this._loadSkyDrivePicker().then(function(e){return n.then(function(t){e.onSuccess(t)})})};t.prototype.cancel=function(){return this._loadSkyDrivePicker().then(function(e){e.onFailure(void 0)})};t.prototype.switchAccount=function(){return H.n.wrap()};t.prototype._loadSkyDrivePicker=function(){var e=this.trackPromise(this._getSkyDrivePicker(this._liveSdkScriptSource).then(function(e){return new H.n(function(t,n){e.init({subscribe:function(e,n){t({onSuccess:e,onFailure:n})}})})}));this._loadSkyDrivePicker=function(){return e};return e};t.prototype._getSkyApiItem=function(e){var t={caller:xn.t.viewerId,m:kn.e.mkt,rset:"skyweb_picker",v:""+Math.random(),d:"1",iabch:"1",pi:"5",path:1,lct:1,id:e.id,urlType:this._urlType},n=xn.t.skyApiBaseUrl+"GetItems?"+Object(je.n)(t),r={"X-SkyApiOriginId":""+Math.random()};return this._dataRequest.send({apiName:"GetItems",url:n,headers:r}).then(function(e){return(e.items||[e.item])[0]})};t.prototype._getValidateSignal=function(){var e=this,t=this._behavior.origin,n=new Sn.e;Dn(t)?this.events.on(window,"message",function(r){var i=""+(r.data||"");if(r.source===window.parent&&r.origin===t&&0===i.indexOf("<file_dialog>")){n.complete({authenticationLevel:2,reason:"origin"});e.events.off(window,"message")}}):n.complete({authenticationLevel:0,reason:"origin"});return n};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{secureExperienceHelperType:Mn});return t})(E.n);function Hn(e){var t,n=kn.e.isINT,r=void 0!==n&&n?"js.live-int.net":"js.live.net";if((new Cn.t(e).getHost()||"").toUpperCase()!==r.toUpperCase())throw new Error("Cannot continue with the picker because the SDK is not from a trusted domain");var i=e.lastIndexOf(".js");i===e.length-3&&(e=e.substring(0,i));Tn.e.addPaths(((t={}).livesdk=e,t));return Object(Nn.e)({path:"livesdk",getModule:function(){return new H.n(function(e,t){window.require(["livesdk"],e,t)})}}).then(function(){return WL&&WL.skydrivePicker})}var Bn,jn,Fn,In,qn=Object(N.o)("Sdk50Handler",Pn),Rn=n(2402);function Un(e){return!!e.scope}function zn(e){var t=((new ae.e).getState(Rn.e)||{}).aad_client_id,n=e.scope,r=Wn(e),i=(function(e){void 0===e&&(e="");var t,n,r,i,s=e.split(":")[1],o=(void 0===s?"":s).split("|"),u=o[0],a=void 0===u?"":u,f=o[1],l=void 0===f?"":f,c=o[2],h=void 0===c?"":c;switch(a.toUpperCase()){case"READWRITEFOLDER":t=1;i=2;break;case"READWRITEFILE":t=1;i=1;break;case"READFOLDER":t=0;i=2;break;default:case"READFILE":t=0;i=1}switch(l.toUpperCase()){case"MULTI":case"MULTIPLE":n=1;break;default:case"SINGLE":n=0}switch(h.toUpperCase()){case"DOWNLOADLINK":r=2;break;case"WEBVIEWLINK":r=0;break;default:case"WEBLINK":r=1}return{accessLevel:t,viewType:i,selectionMode:n,linkType:r}})(n),s=i.accessLevel,o=i.viewType,u=i.selectionMode,a=i.linkType,f=Xn(e),l=(function(e){void 0===e&&(e="");var t=new Cn.t(e).getQueryParameter("redirect_uri");return t&&he(t)})(r);return{showActions:!0,showBranding:!0,showSwitchAccount:!(!l||!f&&!t),accessLevel:s,viewType:o,selectionMode:u,linkType:a,returnUrl:l,aadClientId:t,msaClientId:f,typeFilter:le({viewType:o}),sdkVersion:"6.0"}}function Wn(e){return he(e.ru)}function Xn(e){var t=e.client_id;return(void 0===t?"":t).split(",")[0]}var Vn=((Bn={})[1]="file",Bn[2]="folder",Bn),$n=((jn={})[0]="webViewLink",jn[1]="webLink",jn[2]="downloadLink",jn),Jn=((Fn={})[1]="multi",Fn[0]="single",Fn),Kn=((In={})[1]="readwrite",In[0]="read",In);function Qn(e){var t,n;if(e.msaClientId||e.aadClientId){var r=((t={})[Xt.r]=e.msaClientId,t[Xt.e]=e.aadClientId,t[Xt.u]=e.returnUrl,t[Xt.l]=Vn[e.viewType],t[Xt.f]=Jn[e.selectionMode],t[Xt.n]=$n[e.linkType],t[Xt.t]=Kn[e.accessLevel],t[Xt.s]=Xt.o,t);n="https://onedrive.live.com/picker/accountchooser?"+je.n(r,null,!0)}return n}var Gn=n(981),Yn=n(47),Zn=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.behavior,s=t.returnUrl,o=t.getApplication,u=void 0===o?function(){return H.n.wrap()}:o;r._behavior=i;r._returnUrl=s;r._sharingProvider=n.sharingProvider;r._navigation=n.navigation;r._onGetApplication=u;return r}t.prototype.complete=function(e){var t=this,n=this._behavior,r=n.accessLevel,i=n.linkType,s=this._returnUrl;if(!s)return H.n.wrapError(new Error("No return URL specified to handle completion."));var o=1!==r&&2!==i,u=1===r?2:1;return this.trackPromise(this._onGetApplication().then(function(n){if(!n)return H.n.wrapError({code:1});if(o){var r={role:u,type:4,name:n.name,create:!0,person:n};return t._sharingProvider.manageSharingLinks(e,r).then(function(e){return{userId:e[0].id,itemId:e[0].item.id}})}return t._sharingProvider.share([n],{items:e,roleValue:String(u)}).then(function(e){return{userId:e.people[0].sharingInfo.userId,itemId:e.itemId}})}).then(function(e){var n=[e.itemId];1!==r&&2!==i&&n.push(e.userId);var o={res:"success",resuictx:{uriValue:"selection_"+n.join("!")}};t._navigation.navigateTo({url:s+"&"+je.n(o)})}))};t.prototype.cancel=function(){var e=this._returnUrl;if(!e)return H.n.wrapError(new Error("No return URL specified to handle cancellation."));this._navigation.navigateTo({url:e+"&"+je.n({res:"cancel"})});return H.n.wrap()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{sharingProvider:Gn.resourceKey,navigation:Yn.e});return t})(E.n),er=Object(N.o)("OAuthConsentHelper",Zn),tr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.accountChooserUrl;r._accountChooserUrl=i;r._navigation=n.navigation;return r}t.prototype.switchAccount=function(){var e=this._accountChooserUrl;this._navigation.navigateTo({url:e});return H.n.wrap()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{navigation:Yn.e});return t})(E.n),nr=Object(N.o)("AccountChooserQueryStringHelper",tr),rr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.viewParams,s=t.getApplication,o=r._behavior=zn(i),u=r.scope;r._oAuthConsentHelper=new(u.attached(n.oAuthConsentHelperType))({behavior:o,returnUrl:Wn(i),getApplication:s});r._accountChooserQueryStringHelper=new(u.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:Qn(o)});r._secureExperienceHelper=new(u.attached(n.secureExperienceHelperType))({behavior:o});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{oAuthConsentHelperType:er,accountChooserQueryStringHelperType:nr,secureExperienceHelperType:Mn});return t})(E.n),ir=Object(N.o)("Sdk60Handler",rr);function sr(e){return Un(e)&&!!(new ae.e).getState("picker")}function or(e){var t=(function(e,t){void 0===t&&(t={});var n=t.itemTypeFilterFromViewParams,r=new ae.e,i=r.getState("picker")||{},s=r.getState("options")||{},o=i.accessLevel,u=i.viewType,a=i.linkType,f=i.selectionMode,l=i.filter,c=s.clientId,h=s.advanced.redirectUri,p=!!c&&!!h,d=Ee(u);return{showActions:!0,showBranding:!0,accessLevel:ve(o),viewType:d,linkType:be(a),selectionMode:ge(f),typeFilter:le({typeFilter:pe(l)||!de.e.isActivated("7FC5B3FB-AF5D-4346-9F85-5A57C56A2908","6/24/2021","Fall back to filters from initial URL")&&n,viewType:d}),aadClientId:c,returnUrl:he(h),showSwitchAccount:p,sdkVersion:"7.0"}})();t.msaClientId=Xn(e);return t}function ur(e){var t=e.aadClientId,n=e.returnUrl,r=e.state;if(!t||!n)return"";var i={client_id:t,redirect_uri:n,response_type:{uriValue:"id_token+token"},scope:"profile openid https://graph.microsoft.com/Files.ReadWrite https://graph.microsoft.com/User.Read",response_mode:"fragment",state:void 0===r?"aad_login":r,nonce:oe.e.generate()};return"https://login.microsoftonline.com/common/oauth2/v2.0/authorize?"+je.n(i,null,!0)}var ar=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.viewParams,s=r.scope,o=r._behavior=or(i);r._oAuthConsentHelper=new(s.attached(n.oAuthConsentHelperType))({behavior:o,returnUrl:Wn(i),getApplication:t.getApplication});r._accountChooserQueryStringHelper=new(s.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:ur(o)});r._secureExperienceHelper=new(s.attached(n.secureExperienceHelperType))({behavior:o});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{oAuthConsentHelperType:er,accountChooserQueryStringHelperType:nr,secureExperienceHelperType:Mn});return t})(E.n),fr=Object(N.o)("Sdk70Handler",ar);function lr(e){return(function(e,t){void 0===t&&(t={});return Object(i.__assign)(Object(i.__assign)({},ke(Ne(e),t)),Le(e))})(e)}var cr,hr=n(379);(function(e){var t=(function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getItem=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:t+"?select=*,sharePointIds",accessToken:n,apiName:"GetItem"})};e.prototype.createLink=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:t+"/oneDrive.createLink",accessToken:n,apiName:"CreateLink",postData:JSON.stringify({type:"view"}),requestType:"POST"})};e.dependencies={vroomDataRequestor:hr.e};return e})();e.PickerItemService=t;e.pickerItemServiceResourceKey=new bt.t({name:"PickerItemHelper.internals.pickerItemService",factory:new N.n(t)})})(cr||(cr={}));var pr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._pickerItemService=n.pickerItemService;r._itemPickerProvider=n.itemPickerProvider;r._behavior=t.behavior;return r}t.prototype.getPickerItemsFromItems=function(e,t){var n=this,r=t.hostAuthenticationLevel;return H.n.all(e.map(function(e){var t,i,s=H.n.wrap(n._itemPickerProvider.getPickerItemFromItem(e,{hostAuthenticationLevel:r}));if(r>=2){var o=n._behavior.linkType;4!==o&&2!==o||(s=s.then(function(t){return n._attachDriveItemToPickerItem(e,t)}));4!==o&&3!==o||(s=s.then(function(t){return n._attachShareUrlToPickerItem(e,t)}))}else q.t.isActivated("EC770879-DEBC-4A0E-8078-E84625157D6B","3/18/2021","Attach minimum identity information to picked items")||(null===(t=e.graph)||void 0===t?void 0:t.driveId)&&(null===(i=e.graph)||void 0===i?void 0:i.itemId)||(s=s.then(function(t){return n._attachMinimumIdentityToPickerItem(e,t)}));return s}))};t.prototype._attachDriveItemToPickerItem=function(e,t){var n=t.urls,r=void 0===n?{}:n,s=Object(i.__rest)(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){return Object(i.__assign)(Object(i.__assign)({},s),{urls:Object(i.__assign)(Object(i.__assign)({},r),{download:e["@content.downloadUrl"]}),driveItem:e})})};t.prototype._attachMinimumIdentityToPickerItem=function(e,t){t.urls;var n=Object(i.__rest)(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){var t;return Object(i.__assign)(Object(i.__assign)({},n),{id:e.root?"root":e.id,parentReference:Object(i.__assign)({driveId:null===(t=e.parentReference)||void 0===t?void 0:t.driveId},n.parentReference)})})};t.prototype._attachShareUrlToPickerItem=function(e,t){var n=t.urls,r=void 0===n?{}:n,s=Object(i.__rest)(t,["urls"]);return this._getShareLink(e).then(function(e){return Object(i.__assign)(Object(i.__assign)({},s),{urls:Object(i.__assign)(Object(i.__assign)({},r),{share:e})})})};t.prototype._getOneDrivePickerItem=function(e){var t=this;return H.n.resolve(this.resources.consumeAsync(d.w)).then(function(n){return H.n.resolve().then(function(){return n.getAccessToken(e)||n.refreshAccessToken&&n.refreshAccessToken(e)}).then(function(r){return t._pickerItemService.getItem({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:r})})})};t.prototype._getShareLink=function(e){var t=this;return H.n.resolve(this.resources.consumeAsync(d.w)).then(function(n){return t._pickerItemService.createLink({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:n.getAccessToken(e)}).then(function(e){return e.link.webUrl})})};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{pickerItemService:cr.pickerItemServiceResourceKey,itemPickerProvider:se});return t})(E.n),dr=Object(N.o)("PickerItemHelper",pr),vr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.behavior;r._behavior=i;var s=n.currentWindow,o=void 0===s?window:s,u=r._postMessageTargetSignal=new Sn.e,a=r._hostIdentitySignal=new Sn.e,f=o.parent!==o?o.parent:void 0,l=o.opener,c=i.origin,h=f||l;if(h){var p=r._getOrigin(h,c),d=p.origin,v=p.hostAuthenticationLevel;u.complete({window:h,origin:d});v&&a.complete({authenticationLevel:v,reason:"origin"})}Dn(i.origin)||a.complete({authenticationLevel:0,reason:"origin"});r._pickerItemHelper=new n.pickerItemHelperType({behavior:i});r._responseSignals={};r.events.on(o,"message",r._onMessage);return r}t.prototype.initialize=function(){var e=this._behavior.id,n=this._hostIdentitySignal;this.async.setTimeout(function(){n.complete({authenticationLevel:0,reason:"timeout"})},Xt.i);this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"initialize"}).done(function(e){n.complete({authenticationLevel:0,reason:"invalid"})});return n.getPromise()};t.prototype.complete=function(e){var n=this,r=this._behavior.id;return this._hostIdentitySignal.getPromise().then(function(i){return n._pickerItemHelper.getPickerItemsFromItems(e,{hostAuthenticationLevel:i.authenticationLevel}).then(function(e){return n._sendRequest({conversationId:++t._nextConversationId,pickerId:r,type:"success",items:e})}).then(function(e){if("error"===e.type)return H.n.wrapError(new Error(e.error.message))})})};t.prototype.cancel=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"cancel"}).then(function(e){if("error"===e.type)return H.n.wrapError(new Error(e.error.message))})};t.prototype.switchAccount=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"switch"}).then(function(e){if("error"===e.type)return H.n.wrapError(new Error(e.error.message))})};t.prototype._getOrigin=function(e,t){var n,r;try{var i=e;n=new te.e(i.location.href).authority;r=2}catch(e){t===this._behavior.origin&&(n=t)}return{origin:n,hostAuthenticationLevel:r}};t.prototype._sendRequest=function(e){var t=this;return this._postMessageTargetSignal.getPromise().then(function(n){var r=n.window,i=n.origin;(function(e){if(!e)throw new Error("No specified origin");var t=new Cn.t(e),n=t.getScheme();if(!n||!/http(s)?/.test(n))throw new Error("Invalid origin scheme");var r=t.getHost();if(!r||r.indexOf("*")>-1)throw new Error("Invalid origin host")})(i);var s=e.conversationId,o="[OneDrive-FromPicker]"+JSON.stringify(e),u=new Sn.e;t._responseSignals[s]=u;r.postMessage(o,i);return u.getPromise().then(function(e){delete t._responseSignals[s];return e})})};t.prototype._onMessage=function(e){var t=this,n=""+(e.data||"");if(0===n.indexOf("[OneDrive-ToPicker]"))try{var r=JSON.parse(n.substring("[OneDrive-ToPicker]".length));if(r.pickerId===this._behavior.id){var i=this._postMessageTargetSignal;if("activate"===r.type){var s=this._getOrigin(e.source,e.origin),o=s.hostAuthenticationLevel,u=void 0===o?Dn(e.origin)?2:0:o,a=s.origin;this._hostIdentitySignal.complete({authenticationLevel:u,reason:"origin"});i.complete({window:e.source,origin:a})}i.getPromise().done(function(n){if(e.origin===n.origin){var i=t._responseSignals[r.conversationId];i&&i.complete(r)}})}}catch(e){}};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{pickerItemHelperType:dr});t._nextConversationId=0;return t})(E.n),mr=Object(N.o)("PostMessageHelper",vr),gr=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.viewParams,s=r._behavior=lr(i),o=r.scope;r._postMessageHelper=new(o.attached(n.postMessageHelperType))({behavior:s});r._secureExperienceHelper=new(o.attached(n.secureExperienceHelperType))({behavior:s});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){return this._postMessageHelper.complete(e)};t.prototype.cancel=function(){return this._postMessageHelper.cancel()};t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{postMessageHelperType:mr,secureExperienceHelperType:Mn});return t})(E.n),yr=Object(N.o)("Sdk71Handler",gr),br=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=r._behavior=De(t.viewParams),s=r.scope;r._postMessageHelper=new(s.attached(n.postMessageHelperType))({behavior:i});r._secureExperienceHelper=new(s.attached(n.secureExperienceHelperType))({behavior:i});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){return this._postMessageHelper.complete(e)};t.prototype.cancel=function(){return this._postMessageHelper.cancel()};t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};t.dependencies={postMessageHelperType:mr,secureExperienceHelperType:Mn};return t})(E.n),wr=Object(N.o)("Sdk72Handler",br),Er=n(192),Sr=n(1360),xr=n(103),Tr=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._itemsStore=n.itemsStore;return r}t.prototype.getHandler=function(e){var t=e.viewParams;return{handlerTypeKey:(function(e){return!!e.livesdk})(t)?qn:sr(t)?fr:Un(t)?ir:(function(e){var t=Ne(e);return!!t&&"7.2"===t.sdk})(t)?wr:yr}};t.prototype.getPivots=function(e){var t=e.behavior,n=this._createFilesRootItem(t),r=this._createPhotosRootItem(t),i=[];n&&i.push({item:n,isActive:this._isCurrentViewFiles});r&&i.push({item:r,isActive:this._isCurrentViewPhotos});return{pivots:i}};t.prototype.getItemFromPickerItem=function(e){var t;return{key:this._urlDataSource.getKey(((t={}).id=e.id,t)),id:e.root?"root":e.id}};t.prototype.getPickerItemFromItem=function(e){return{root:re.optional("root"===e.id?{}:void 0),endpoint:this._urlDataSource.getApiBaseUrl({apiVersion:"v1.0",driveId:e.ownerId})}};t.prototype._isCurrentViewFiles=function(e){return!e.qt};t.prototype._isCurrentViewPhotos=function(e){return"allmyphotos"===e.qt};t.prototype._createFilesRootItem=function(e){var t=e.typeFilter,n=void 0===t?{filters:[]}:t,r=new Er.e(this._urlDataSource.getKey(this._urlDataSource.saveItemTypeFilter(n)));r.name=Sr.e;r.displayName=Sr.e;r.properties.commandsSupported={defc:"1"};r.type=j.e.Folder;var i=this._itemsStore.getItem(r.key);i&&!i.peek().isPlaceholder||this._itemsStore.setItem(r);return r};t.prototype._createPhotosRootItem=function(e){for(var t,n,r=e.typeFilter,i=void 0===r?{filters:[]}:r,s=0===i.filters.length,o=0,u=i.filters;o<u.length;o++){var a=u[o];if(s)break;if("string"==typeof a);else switch(a){case I.e.media:case I.e.file:case I.e.photo:case I.e.video:s=!0}}if(s){(n=new Er.e(this._urlDataSource.getKey(((t={}).qt="allmyphotos",t)))).name=Sr.i;n.displayName=Sr.i;n.properties.commandsSupported={defc:"1"};n.type=j.e.Folder;var f=this._itemsStore.getItem(n.key);f&&!f.peek().isPlaceholder||this._itemsStore.setItem(n)}return n};t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{urlDataSource:d.ye,itemsStore:xr.e});return t})(E.n),Nr=Object(N.s)("ItemPickerDataSource",Tr),Cr=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables;r._switchAccountAction=new(r.child(n.itemPickerActionMap.ItemPickerSwitchAccountAction));var s=i.createArray();s.push({url:"#",action:r._switchAccountAction,isActive:i.create(!1),isFocused:i.create(!1),text:v.g,engagementName:"SwitchAccount",altText:v.g,icon:new Qe.e("Contact")});(r.linkGroups=i.createArray()).push({text:"",url:void 0,isActive:i.create(!1),isFocused:i.create(!1),automationId:"switchAccount",hideGroupHeader:!0,isExpanded:i.create(!0),links:r.scope.attach(s.filter(function(e){return e.action.isAvailable()}))});return r}t.dependencies=Object(i.__assign)(Object(i.__assign)({},E.n.dependencies),{itemPickerActionMap:p.e});return t})(E.n),kr=Object(N.o)("SwitchAccountLeftNavHandler",Cr),Lr=new bt.t({name:"OneDriveLeftNavHandler.key",loader:new N.t(function(){return n.ee([418],3266).then(function(e){return e.typeResourceKey.local})})}),Ar=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHandlerTypeKeys=function(){return[Lr,kr]};return t})(E.n),Or=Object(N.s)("LeftNavDataSource",Ar),Mr=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r.addBindingHandlers({host:y.e});var i,s=r.resources;s.exposeFactory(d.P,new N.e(Nr));s.exposeFactory(d.F,new N.e(Or));if(t.agent)i=t;else{var o=new(r.child(En));i={agent:o.getAgent(),behavior:o.getBehavior()}}r.filePickerTagName=bn.tagName;r.filePickerParams=i;return r}return t})(s.t),_r=r.e({tagName:"od-consumer-file-picker",template:"\x3c!--ko component:{name:filePickerTagName,params:filePickerParams}--\x3e\x3c!--ko host:{data:$host}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModel:Mr,synchronous:!0});t.default=_r},653:function(e,t,n){"use strict";n.d(t,"h",function(){return i});n.d(t,"l",function(){return s});n.d(t,"d",function(){return o});n.d(t,"m",function(){return u});n.d(t,"M",function(){return a});n.d(t,"v",function(){return f});n.d(t,"f",function(){return l});n.d(t,"u",function(){return c});n.d(t,"o",function(){return h});n.d(t,"a",function(){return p});n.d(t,"A",function(){return d});n.d(t,"x",function(){return v});n.d(t,"r",function(){return m});n.d(t,"P",function(){return g});n.d(t,"b",function(){return y});n.d(t,"F",function(){return b});n.d(t,"t",function(){return w});n.d(t,"C",function(){return E});n.d(t,"y",function(){return S});n.d(t,"n",function(){return x});n.d(t,"H",function(){return T});n.d(t,"T",function(){return N});n.d(t,"N",function(){return C});n.d(t,"O",function(){return k});n.d(t,"S",function(){return L});n.d(t,"w",function(){return A});n.d(t,"k",function(){return O});n.d(t,"L",function(){return M});n.d(t,"D",function(){return _});n.d(t,"B",function(){return D});n.d(t,"j",function(){return P});n.d(t,"I",function(){return H});n.d(t,"i",function(){return B});n.d(t,"_",function(){return j});n.d(t,"g",function(){return F});n.d(t,"E",function(){return I});n.d(t,"e",function(){return q});n.d(t,"p",function(){return R});n.d(t,"c",function(){return U});n.d(t,"s",function(){return z});var r=n(38),i=new r.e("displayName"),s=new r.e("deleted"),o=new r.e("fileName"),u=new r.e("folder"),a=new r.e("parentFolderItem"),f=new r.e("fileSize"),l=new r.e("dateModified"),c=new r.e("dateCreated"),h=new r.e("dateAccessed"),p=new r.e("dateFollowed"),d=new r.e("modifiedBy"),v=new r.e("isShared"),m=new r.e("averageRating"),g=new r.e("ratingCount"),y=new r.e("hasUserRated"),b=new r.e("userRating"),w=new r.e("allRatings"),E=new r.e("likesCount"),S=new r.e("hasUserLiked"),x=new r.e("analyticsKey"),T=new r.e("relatedFilesKey"),N=new r.e("likedByItemFacet"),C=new r.e("likedByPeopleFacet"),k=new r.e("openUrl"),L=new r.e("isNew"),A=new r.e("isCheckedOut"),O=new r.e("malwareDetected"),M=new r.e("missingMetadata"),_=(new r.e("needsPublishing"),new r.e("policyTip")),D=new r.e("retentionPolicy"),P=new r.e("showRetentionPolicyIconFacet"),H=new r.e("vroomUrl"),B=new r.e("canonicalUrl"),j=new r.e("parentFolderItemName"),F=new r.e("followedItem"),I=new r.e("isFollowed"),q=new r.e("activityItem"),R=new r.e("eTag"),U=new r.e("description"),z=new r.e("datasource")},661:function(e,t,n){e.exports=n(905)()},703:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(25),s=n(7),o=n(5),u=n(137),a=n(40),f=n(192),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.s.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.C.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.s.lazy.optional,itemSetSelectionModel:o.C.lazy.optional,selectionHelper:u.t.lazy.optional}))},735:function(e,t,n){"use strict";n.d(t,"v",function(){return i});n.d(t,"a",function(){return s});n.d(t,"p",function(){return o});n.d(t,"t",function(){return u});n.d(t,"s",function(){return a});n.d(t,"o",function(){return f});n.d(t,"n",function(){return l});n.d(t,"r",function(){return c});n.d(t,"i",function(){return h});n.d(t,"g",function(){return p});n.d(t,"e",function(){return d});n.d(t,"c",function(){return v});n.d(t,"l",function(){return m});n.d(t,"f",function(){return g});n.d(t,"m",function(){return y});n.d(t,"h",function(){return b});n.d(t,"d",function(){return w});n.d(t,"u",function(){return E});var r=n(38),i=new r.e("thumbnail"),s=new r.e("dimensions"),o=new r.e("photo"),u=new r.e("cameraExposure"),a=new r.e("cameraMake"),f=new r.e("cameraModel"),l=new r.e("cameraFNumber"),c=new r.e("cameraFocalLength"),h=new r.e("cameraIso"),p=new r.e("video"),d=new r.e("bitRate"),v=new r.e("frameRate"),m=new r.e("fourCC"),g=new r.e("duration"),y=new r.e("videoAudio"),b=new r.e("livePhoto"),w=new r.e("samsungMotionPhoto"),E=new r.e("dateTaken")},755:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"i",function(){return s});n.d(t,"t",function(){return o});n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});var r=n(38),i=new r.e("fileIconType"),s=new r.e("oneNote"),o=new r.e("iconFacet"),u=o,a=new r.e("iconImage")},789:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(0),i=n(232),s=n(148),o=n(880);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=new i.e,o=n.resolve,u=n.reject,a=n.promise;t&&t.throwIfCanceled();f=e!==1/0?window.setTimeout(function(){return o()},e):void 0;l=t&&t.subscribe(function(){f&&window.clearTimeout(f);u(new s.e)});r.label=1;case 1:r.trys.push([1,,3,4]);return[4,a];case 2:r.sent();return[3,4];case 3:l&&l();return[7];case 4:return[2]}})})}function a(e,t){var n="number"==typeof e?{timeout:e}:e,i=n.timeout,u=n.errorProps,a=void 0===u?{}:u,f=new s.t,l=t&&t.subscribe(f.cancel),c=i!==1/0?window.setTimeout(function(){f.cancel(new o.e(Object(r.__assign)({timeout:i},a)))},i):void 0;c&&f.token.subscribe(function(){window.clearTimeout(c)});return Object(r.__assign)(Object(r.__assign)({},f),{dispose:function(){c&&clearTimeout(c);l&&l();f.dispose()}})}},812:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","oft","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},fluid:{extensions:["fluid","loop"]},form:{},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},officescript:{extensions:["osts"]},splist:{},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","jxr","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx","classifier"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},stream:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}}},820:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});var r=n(0),i=n(26),s=n(661),o={dependencies:s.object.isRequired};function u(e,t){var n=e,s={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return s};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},o);return t})(i.Component)}function a(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},830:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(820),s=n(3),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},845:function(e,t,n){"use strict";var r=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.e=r},880:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=t.timeout,i=Object(r.__rest)(t,["timeout"]),s=e.call(this,Object(r.__assign)(Object(r.__assign)({message:"Timeout"},i),{extraData:{timeout:n}}))||this;s.timeout=n;s.name="TimeoutError";return s}return t})(n(101).e)},905:function(e,t,n){"use strict";var r=n(906);function i(){}function s(){}s.resetWarningCache=i;e.exports=function(){function e(e,t,n,i,s,o){if(o!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");u.name="Invariant Violation";throw u}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};n.PropTypes=n;return n}},906:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},981:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return g});var r=n(0),i=n(335),s=n(40),o=n(14),u=n(32),a=n(81),f=n(47),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;return r}t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)};t.dependencies={sharingDataSource:o.oe};return t})(i.e),c=Object(s.s)("ShareItemHelper",l),h=n(25),p=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(h.n.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){h.n.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})(),d=n(8),v=n(4),m=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new p({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){n._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.UNSAFE_parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.UNSAFE_parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].UNSAFE_parent&&e[0].UNSAFE_parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.UNSAFE_parent&&e.UNSAFE_parent.key&&(e.queryType!==d.e.Search||!Object(v.isFeatureEnabled)(v.DisableShareInvalidateItemInSearchView))&&this._itemProvider.invalidateItem(e.UNSAFE_parent.key)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{sharingDataSource:o.oe,sharingDataDataSource:o.ue.optional,navigation:f.e,externallySharedItemProvider:u.i.optional,itemProvider:a.resourceKey.optional,shareItemHelper:c});return t})(i.e),g=(t.default=m,Object(s.s)("SharingProvider",m))},1006:function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"n",function(){return v});n.d(t,"r",function(){return m});n.d(t,"o",function(){return y});n.d(t,"s",function(){return b});n.d(t,"i",function(){return w});n.d(t,"e",function(){return E});var r=n(41),i=n(62),s=n(37),o=n(172),u=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],a="Doc",f="Ppt",l="Xls",c="Vsd",h="Lib",p={WinDocuments:h,WinLibrary:h,WinMusic:h,WinPictures:h,WinPodcastLibrary:h,WinVideos:h,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:a,Docm:a,Docx:a,Dot:a,Dotm:a,Dotx:a,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:f,Ods:l,Odt:a,One:"One",Onepkg:"One",Onetoc2:"One",Notebook:"OneNotebook",Pot:f,Potm:f,Potx:f,Ppa:f,Ppam:f,Pps:f,Ppsm:f,Ppsx:f,Ppt:f,Pptm:f,Pptx:f,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:c,Vsd:c,Vsdm:c,Vsdx:c,Vsl:c,Vss:c,Vssm:c,Vssx:c,Vst:c,Vstm:c,Vstx:c,Xaml:"Xaml",Xla:l,Xlam:l,Xll:l,Xls:l,Xlsb:l,Xlsm:l,Xlsx:l,Xlt:l,Xltm:l,Xltx:l,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function d(e,t,n){var o=e.extension,u=o&&o.slice("."===o[0]?1:0),a=u&&u.toUpperCase(),f=g(e.itemFromServer&&e.itemFromServer.iconType||u);return e.isDocSet?i.fileTypeDocSet:f||e.type!==r.e.Folder?n||(e.panorama?i.fileTypePanorama:e.photo&&!e.video?s.format(i.fileTypeImage,a||"").trim():f?i["fileType"+f]:a?s.format(i.fileTypeUnknown,a):t?i.listItemType:i.fileTypeNoExtension):i.fileTypeFolder}function v(e){var t=e.slice(e.lastIndexOf(".")+1);return s.format(i.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):i.fileTypeNoExtension)}function m(e){var t=i.fileTypeNoExtension;if(!e)return t;var n=g(s.capitalize(e));if(n)return i["fileType"+n];var r=e.toUpperCase();return r?s.format(i.fileTypeUnknown,r):t}function g(e){return p[e]}function y(e){return e&&-1!==u.indexOf(e)}function b(e){return w(e)&&!!e.properties.newTag}function w(e){return!!e.properties&&!!e.properties.autoAlbumTag}function E(e){if(!e)return o.e.Word;var t=g(s.capitalize(e.split(".").pop()));return"One"===t?o.e.OneNote:t===f?o.e.PowerPoint:t===l?o.e.Excel:t===c?o.e.Visio:o.e.Word}},1007:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(26),s=n(1059),o=n(383),u=n(789),a=new WeakMap,f=new Map,l=new WeakMap;function c(e,t){void 0===t&&(t={});var n=t.useChildrenAsPlaceholder,c=void 0!==n&&n,h=function(){return(function(e){var t=l.get(e);t||l.set(e,t=e().then(function(t){var n=Object(s.e)(t);a.set(e,n);return n}).catch(function(t){l.delete(e);return Promise.reject(t)}));return t})(e)},p=function(){if(a.has(e))return a.get(e)};function d(e){var t=this,n=i.useState(function(){return{}}),s=e.placeholder,a=e.children,l=e.barrier,d=Object(r.__rest)(e,["placeholder","children","barrier"]),v=Object(o.e)(function(){return d},d),m=i.useState(function(){return p()}),g=m[0],y=m[1],b=i.useRef(y),w=i.useState(),E=w[0],S=w[1],x=i.useRef(S);i.useLayoutEffect(function(){return function(){b.current=void 0;x.current=void 0;f.delete(n)}},[]);i.useLayoutEffect(function(){if(f.size>0){var e=[];f.forEach(function(t){e.push(t)});f.clear();for(var t=0,n=e;t<n.length;t++){(0,n[t])()}}});i.useLayoutEffect(function(){g||E||Object(r.__awaiter)(t,void 0,void 0,function(){var e,t,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);return l?[4,l]:[3,2];case 1:r.sent();r.label=2;case 2:return[4,h()];case 3:e=r.sent();return[3,5];case 4:i=r.sent();t=i;return[3,5];case 5:f.set(n,function(){e?b.current&&b.current(function(){return e}):t&&x.current&&x.current(t)});return[4,Object(u.t)(0)];case 6:r.sent();if(s=f.get(n)){f.delete(n);s()}return[2]}})})},[]);return i.useMemo(function(){if(E)throw E;return g?i.createElement(g,Object(r.__assign)({},v,{children:a})):c?i.createElement(i.Fragment,null,a):s?i.createElement(i.Fragment,null,s):null},[v,s,a,g,E])}d.asAsync={load:h,getComponent:p,options:t};return d}},1038:function(e,t,n){"use strict";var r=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.e=r},1059:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return e.default||e}},1060:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i=n(812);function s(e){if(!r){r={};for(var t in i.e)if(i.e.hasOwnProperty(t)){var n=i.e[t].extensions;if(n)for(var s=0;s<n.length;s++)r[n[s]]=t}}e=e.replace(".","").toLowerCase();return r[e]||"genericfile"}},1073:function(e,t,n){"use strict";var r=n(0),i=n(187),s=n(25),o=n(34),u=n(47),a=n(5),f=n(20),l=n(184),c=n(3),h=n(40),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,o=t.target,f=void 0===o?"_top":o,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(u.e):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(a.H):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return s.n.wrap({resultType:o.e.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+f.n(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=f.e(s);return!l.e(n,o)}return e!==r};t.dependencies={resources:c.s,navigation:u.e,viewParamsObservable:a.H};return t})(i.e);t.e=p;Object(h.o)("NavigationAction",p)},1129:function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"c",function(){return s});n.d(t,"o",function(){return o});n.d(t,"t",function(){return u});n.d(t,"s",function(){return a});n.d(t,"p",function(){return f});n.d(t,"i",function(){return l});n.d(t,"h",function(){return c});n.d(t,"r",function(){return h});n.d(t,"e",function(){return p});n.d(t,"u",function(){return d});n.d(t,"f",function(){return v});n.d(t,"a",function(){return m});n.d(t,"l",function(){return g});var r=n(1038),i=new r.e("createFolder"),s=new r.e("rename"),o=new r.e("moveFrom"),u=new r.e("copyFrom"),a=(new r.e("moveTo"),new r.e("copyTo"),new r.e("deleteItem")),f=new r.e("restoreItem"),l=new r.e("deleteAllItems"),c=new r.e("restoreAllItems"),h=new r.e("createText"),p=new r.e("changeExpiration"),d=new r.e("open"),v=new r.e("openInTextEditor"),m=new r.e("openInImageEditor"),g=new r.e("openPdfInBrowser");new r.e("quickEdit"),new r.e("editItem"),new r.e("createShortcut"),new r.e("pinToMru"),new r.e("printPdf")},1248:function(e,t,n){"use strict";n.d(t,"n",function(){return d});n.d(t,"e",function(){return v});n.d(t,"r",function(){return m});n.d(t,"t",function(){return g});var r=n(0),i=n(7),s=n(25),o=n(189),u=n(380),a=n(149),f=n(1448),l=n(20),c=n(385),h=1e3,p=n(404),d="__New",v="__Auto",m="__WeekendRecap",g="__EventRecap",y=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.n);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),a={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new u.e).send({requestType:"POST",postData:JSON.stringify(a),apiName:t.MODIFY_ALBUM_API_NAME+"."+a.action,url:this._getModifyAlbumUrl(),isErrorExpectedCallback:p.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var u={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(o,u).then(function(t){return e},function(e){var t={errorType:c.e.other,error:new Error(e.data.message)};return s.n.wrapError(t)})},function(e){var t=c.e.other;e.data.code===h&&(t=c.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return s.n.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new u.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new u.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+i.action,url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:p.e})};t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),i=new u.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+o.action,url:r,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:p.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return s.n.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return f.e.start({apiName:t.MODIFY_ALBUM_API_NAME+"."+n.action,url:r,batchSize:20,items:e,isErrorExpectedCallback:p.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return a.t.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums";return t})(i.n);t.i=y},1249:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(27),s=n(10),o=n(190),u=n(92);function a(e,t){var n=(function(t){Object(r.__extends)(n,t);function n(e,n){var r=t.call(this,e,n)||this;r.addBindingHandlers({react:o.t,host:u.e});var i=r.observables;r.reactParams={componentType:n.componentType,error:e.error,rootProps:e.rootProps,props:i.wrap(e.props),useDOMContext:e.useDOMContext};return r}n.dependencies=Object(r.__assign)(Object(r.__assign)({},s.t.dependencies),{componentType:e.local});return n})(s.t);return Object(i.t)({automationName:t.automationName,name:t.name,template:'<div role="presentation" data-bind="react:reactParams">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:n})}},1300:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(7),s=n(14),o=n(40),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandDataSource:s.O});return t})(i.n),a=Object(o.s)("ItemCommandProvider",u)},1301:function(e,t,n){"use strict";var r=n(12);Object(r.n)([{rawString:".od-ItemContent-header{box-sizing:border-box;display:flex;flex-flow:row wrap;align-items:flex-end;padding-top:10px;padding-bottom:10px}.xlg .od-ItemContent-header,.xxlg .od-ItemContent-header,.xxxlg .od-ItemContent-header,.xxxxlg .od-ItemContent-header{padding-top:32px;padding-bottom:0}.od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 32px 20px;max-width:800px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:";font-weight:600;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.sm .od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 16px 20px}.xxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxxlg .od-FolderItemContent .StorageInfo-sectionHeading{max-width:1080px}.lg .od-FolderItemContent .od-ItemContent-progress-container,.md .od-FolderItemContent .od-ItemContent-progress-container,.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 16px 40px}.xxlg .od-FolderItemContent .od-ItemContent-progress-container,.xxxlg .od-FolderItemContent .od-ItemContent-progress-container,.xxxxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.od-FolderItemContent .od-ItemContent-progress-container{max-width:800px;box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108);border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";margin:0 32px 20px;padding:24px 0}.od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main{display:flex;flex-direction:column}.od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main .od-quota-progress-bar-top{order:1;margin-top:12px}.od-FolderItemContent .od-ItemContent-progress-container .StorageInfo-totalUsed{font-weight:600}.od-FolderItemContent .od-ItemContent-progress-container .od-ItemContent-progress{padding:0 24px;margin-top:12px;height:46px}.od-FolderItemContent .StorageInfo-totalUsed{margin:0 24px}.od-ItemContent-progress{height:31px;padding:10px 32px}.md .od-ItemContent-progress,.sm .od-ItemContent-progress{padding-left:16px;padding-right:16px}.od-ItemContent-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.lg .od-ItemContent-title,.md .od-ItemContent-title,.sm .od-ItemContent-title{margin-top:10px;margin-bottom:10px}.xlg .od-ItemContent-title,.xxlg .od-ItemContent-title,.xxxlg .od-ItemContent-title,.xxxxlg .od-ItemContent-title{margin-bottom:4px;line-height:36px}.od-ItemContent-breadcrumb{font-size:17px;font-weight:300}.md .od-ItemContent-breadcrumb,.sm .od-ItemContent-breadcrumb{font-size:14px;font-weight:400}.xlg .od-ItemContent-breadcrumb,.xxlg .od-ItemContent-breadcrumb,.xxxlg .od-ItemContent-breadcrumb,.xxxxlg .od-ItemContent-breadcrumb{font-size:21px;font-weight:100;margin-bottom:1px;margin-top:14px}.xlg .od-ItemContent-list,.xxlg .od-ItemContent-list,.xxxlg .od-ItemContent-list,.xxxxlg .od-ItemContent-list{padding-top:20px}.od-ItemContent-footer{margin:0}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-left:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-right:32px}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-right:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-left:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-left:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-right:16px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-right:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-left:16px}.od-ItemContent-header-sharedIndicator{display:inline-block;position:relative;padding:0}.od-ItemContent-header-sharedIndicator .od-ItemContent-metadata{padding-bottom:3px;margin:0}"}])},1351:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(187),s=n(34),o=n(7),u=n(25),a=n(135),f=n(527),l=n(1702),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.state,i=t.source,s=t.useToggleBehavior,o=t.getParams;if((function(e){return!!e.moduleDefinition})(i)){var a=i.moduleDefinition;n._getComponentDefinition=function(){return Object(f.e)(a)}}else{var c=i.component;n._getComponentDefinition=function(){return u.n.wrap(c)}}n._useToggleBehavior=s;n._state=r;n._getParams=o;n._action=n.createObservable();n._hiddenDomProvider=n.resources.consume(l.e);n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i){i.cancel();return u.n.wrap()}}var s=new a.e,o={complete:function(){s.complete()},fail:function(e){s.error(e)},cancel:function(){s.cancel()}};this._useToggleBehavior&&this._action(o);return u.n.as(this._getParams()).then(function(i){return n._getComponentDefinition().then(function(u){t={name:u.tagName,params:Object(r.__assign)(Object(r.__assign)({action:o,event:e},i||{}),{resources:n.resources})};n._hiddenDomProvider.requestControl(t);return s.getPromise()})}).then(function(){t&&n._hiddenDomProvider.disposeControl(t);n._action.peek()===o&&n._action(void 0)},function(e){t&&n._hiddenDomProvider.disposeControl(t);n._action.peek()===o&&n._action(void 0);return u.n.wrapError(e)})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t})(o.n);var h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.name,i=t.source,s=t.handlerType,o=t.actionParams,u=t.useToggleBehavior,a=void 0!==u&&u;n.name=r;var f=s?new(n.managed(s))(o):void 0,l=f&&f.state||n.createObservable({isAvailable:!0}),h=f&&f.getParams?function(){return f.getParams()}:function(){};n._controlExecutorLoader=new(n.managed(c))({source:i,state:l,useToggleBehavior:a,getParams:h});return n}t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:s.e.Success}})};return t})(i.e);function p(e){var t=e.name,n=e.source,i=e.useToggleBehavior,s=e.handlerType;return(function(e){Object(r.__extends)(o,e);function o(r){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:r,handlerType:s})||this}return o})(h)}},1358:function(e,t,n){"use strict";var r;(function(e){e[e.allTags=0]="allTags";e[e.allPlaces=1]="allPlaces";e[e.singleTag=2]="singleTag";e[e.singlePlace=3]="singlePlace"})(r||(r={}));t.e=r},1361:function(e,t,n){"use strict";var r=n(0),i=n(10),s=n(25),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.action;n.action=r;return n}t.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})};t.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){t.action.fail(e);return s.n.wrapError(e)})};return t})(i.t);t.e=o},1437:function(e,t,n){"use strict";n.d(t,"e",function(){return T});var r=n(12);Object(r.n)([{rawString:".EmptyFolder{text-align:center}.EmptyFolder.EmptyFolder-content-vault{padding-top:95px}.EmptyFolder-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.EmptyFolder-image .EmptyFolder-imageTag{height:208px;width:auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;max-width:400px;margin:0 auto;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:";font-weight:600}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-size:17px;font-weight:300;padding-top:64px}.EmptyFolder-subText{font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto;padding:8px 16px 0}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}.EmptyFolder-subTextPart2Link-metadataSearch{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.EmptyFolder-subTextPart2Link-metadataSearch:focus,.EmptyFolder-subTextPart2Link-metadataSearch:hover{color:"},{theme:"themeDarker",defaultValue:"#052a65"},{rawString:"}"}]);var i=n(0),s=n(562),o=n(37),u=n(10),a=n(376),f=n(5),l=n(14),c=n(32),h=n(378),p=n(2009),d=n(9),v=n(95),m=n(8),g=n(119),y=n(18),b='<i class="EmptyFolder-icon '+Object(s.C)("Add")+'" ></i>',w='<a class="EmptyFolder-subTextPart2 EmptyFolder-subTextPart2Link" href="#" data-bind="click: navigateToRecentDocs">',E=y.e.isActivated("e2e1e3d8-7127-4eb4-98c0-5defc12378fc","11/22/2021","Move link outside of live region so its not announced by narrator"),S=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({bindableHtml:h.e});var i=r.observables;r.isDocLib=!0;r._urlDataSource=n.urlDataSource;r._content=i.pureCompute(r._computeContent);r._currentPage=r._urlDataSource.getPageType();r._isViewOnly=t.isViewOnly;r._item=n.item;r._itemParentHelper=n.itemParentHelper;r._storageOptionsProvider=n.storageOptionsProvider;r._userInfoProvider=n.userInfoProvider;r._viewParams=n.viewParams;r._isOneDriveXboxApp=Object(g.t)();r._recentDocsNavigationAction=new(r.managed(n.actionMap.NavigationAction))({target:"blank",url:i.pureCompute(function(){return r._urlDataSource.getRecentQueryUrl()})});r.altText=i.pureCompute(function(){return r._content().altText||""});r.subText=i.pureCompute(function(){return r._content().subText});r.subLink=i.pureCompute(function(){return E?"":r._content().subLink});r.subTextMobile=i.pureCompute(function(){return r._content().subTextMobile||r._content().subText});r.subLinkMobile=i.pureCompute(function(){return E?"":r._content().subLinkMobile||r._content().subLink});r.subTextPostIcon=i.pureCompute(function(){return r._content().subTextPostIcon});r.title=i.pureCompute(function(){return r._content().title});r.url=i.pureCompute(function(){return r._content().url});r.additionalContentCss=i.pureCompute(function(){return r._computeContentCss()});return r}t.prototype.navigateToRecentDocs=function(){this._recentDocsNavigationAction.execute(null);return!1};t.prototype.hasInsertPermission=function(){return!this.observables.unwrap(this._isViewOnly)};t.prototype.emptyFolderSubText=function(){return this._isOneDriveXboxApp?"":p.p};t.prototype.hasSmartFiltersApplied=function(){return!1};t.prototype.onComputeContent=function(){var e,t=this._item(),n=t.queryType,r=this.hasInsertPermission();switch(n){case m.e.Recent:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recent_v2.svg"),title:p.A,subText:p.L};break;case m.e.RecycleBin:case m.e.SecondStageRecycleBin:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recyclebin_v2.svg"),title:p.M,subText:p.O};break;case m.e.Search:case m.e.SearchOdbScope:var s=void 0,u=void 0;if(this._currentPage===d.e.Photos)s=p.T;else if(this.isDocLib)if(E)s=o.format(p._,w,"</a>");else{s="";u=o.format(p._,w,"</a>")}else s=p.g;e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search_v2.svg"),title:p.D,subText:s,subLink:u};break;case m.e.SharedWithMe:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared_v2.svg"),title:p.H,subText:p.P};break;case m.e.DocsInCommon:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared_v2.svg"),title:p.o,subText:p.s};break;case m.e.Subsites:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_sites.svg"),title:p.B,subText:""};break;case m.e.Apps:e=this._getSearchContentOrDefault(p.i);break;case m.e.Popular:e=this._getSearchContentOrDefault(p.k);break;case m.e.ExternallyShared:e=this._getSearchContentOrDefault(p.u);break;case m.e.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:var a=!1;this._itemParentHelper.getAncestorOrSelf(t,function(e){return"Music"===e.specialFolderCanonicalName})&&(a=!0);if(a){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_folder_v2.svg"),title:p.S,subText:r&&p.E||"",subTextMobile:r&&o.format(p.w,b)||""};if(this._userInfoProvider){var f=this._userInfoProvider.getMarket();f=f&&f.toLowerCase()}break}if(this.hasSmartFiltersApplied()){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_filter.svg"),title:p.l,subText:p.f,altText:p.a};break}if(t.vault&&t.vault.root){var l=this._computeIsPremium()?p.j:p.e;e={title:p.F,subText:l,url:""};break}if(this._item().isRootFolder&&!this.isDocLib)e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_list.svg"),title:p.b,subText:p.y,altText:p.m};else{var c=window.require.toUrl("odsp-media/images/emptyfolder/empty_documents.svg"),h=window.require.toUrl("odsp-media/images/emptyfolder/empty_folder_v2.svg");e={url:this._item().isRootFolder?c:h,title:this._item().isRootFolder?p.v:p.d,subText:r&&this.emptyFolderSubText()||"",subTextMobile:r?o.format(p.h,b):void 0}}}return Object(i.__assign)({altText:p.c},e)};t.prototype._computeContent=function(){return this.onComputeContent()};t.prototype._getSearchContentOrDefault=function(e){return this._viewParams().q?{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search_v2.svg"),title:p.D,subText:""}:{title:e,url:"",subText:""}};t.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case v.e.singleAlbum:case v.e.Albums:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_album_albumsview.svg"),title:p.n,subText:p.t};break;case v.e.allTags:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"),title:p.C,subText:E?o.format(p.N,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>"):"",subLink:E?"":o.format(p.N,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case v.e.allPlaces:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_places.svg"),title:p.r,subText:""};break;case v.e.onThisDay:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_onthisday.svg"),title:p.x,subText:""};break;default:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_allphotosview.svg"),title:p.r,subText:""}}return e};t.prototype._computeIsPremium=function(){return!(!this._storageOptionsProvider||!this._storageOptionsProvider.isReady())&&this._storageOptionsProvider.hasOffice.peek()};t.prototype._computeContentCss=function(){var e=this._item();return e.vault&&e.vault.root?"EmptyFolder-content-vault":""};t.dependencies=Object(i.__assign)(Object(i.__assign)({},u.t.dependencies),{actionMap:f.e,item:f.s,itemParentHelper:a.e,urlDataSource:l.ye,userInfoProvider:c.L.optional,viewParams:f.H,storageOptionsProvider:c.S.optional});return t})(u.t),x=n(27),T=Object(x.t)({automationName:"ms-empty-folder",name:"EmptyFolder",template:'<div class="EmptyFolder" data-bind="class:additionalContentCss">\x3c!--ko if:url--\x3e<div class="EmptyFolder-image"><img id="emptyFolderImg" class="EmptyFolder-imageTag" data-bind="attr:{src:url,alt:altText}"></div>\x3c!--/ko--\x3e<div role="alert"><div class="EmptyFolder-title" data-bind="text:title"></div>\x3c!--ko if:subText||subTextMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subText"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subTextMobile"></span></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:subLink||subLinkMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subLink"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subLinkMobile"></span></div>\x3c!--/ko--\x3e</div>',viewModelType:S})},1448:function(e,t,n){"use strict";var r=n(135),i=n(380),s=(function(){function e(){}e.start=function(e){var t=new r.e(function(){for(var e=0,t=o;e<t.length;e++){t[e].cancel()}}),n=e.items.slice(),s=e.parallelRequests||1,o=[];function u(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function a(){var r=new i.e,s=n.splice(0,e.batchSize),f=JSON.stringify(e.getPostData(s)),l=r.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:f,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){u(l);e.onBatchComplete&&e.onBatchComplete(s);n.length?a():t.complete()},function(e){u(l);(function(e){t.error(e)})(e)});o.push(l)}for(var f=0;n.length>0&&f<s;f++)a();return t.getPromise()};return e})();t.e=s},1479:function(e,t,n){"use strict";var r=n(12);Object(r.n)([{rawString:".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar,.xxxxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.BreadcrumbBar-list{margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.BreadcrumbBar-list li:last-child .BreadcrumbBar-item{font-weight:600}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;padding:8px 4px;cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:5px 8px}.BreadcrumbBar-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.BreadcrumbBar-navItem:active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}a.BreadcrumbBar-item{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-size:17px;font-weight:300}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:21px;font-weight:100;padding-bottom:1px;line-height:28px}.lg .BreadcrumbBar-item,.md .BreadcrumbBar-item,.sm .BreadcrumbBar-item,.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:";line-height:24px;height:24px}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:0 2px;margin-top:11px}.lg .BreadcrumbBar-item-chevron{margin-top:10px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{padding:0 4px;margin-top:7px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:"},{theme:"smallFontWeight",defaultValue:"400"},{rawString:"}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76c'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76b'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:21px;font-weight:100}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:28px;font-weight:100;line-height:1}"}]);var i=n(0),s=n(1),o=n(136),u=n(124),a=n(210),f=n(204),l=n(67),c=n(53),h=n(10),p=n(1073),d=n(47),v=n(16),m=n(71),g=n(376),y=n(5),b=n(1360),w=n(2006),E=n(37),S=n(52),x=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._currentDroppingCrumb=null;n.addBindingHandlers({dismiss:u.e,dragAndDrop:a.e,keyboard:m.e});var r=t.iconClass,i=void 0===r?new v.e("More").getClass():r,o=t.canShowTooltipOverflow,h=void 0!==o&&o;n._responsiveUI=n.resources.consume(c.n);n._navigation=n.resources.consume(d.e);n._itemParentHelper=n.resources.consume(g.e);n.overflowMenuAriaLabel=w.n;n.iconClass=i;n._item=t.item;n._maxFoldersVisibleLgUp=t.maxFoldersVisibleLgUp;n._maxFoldersVisibleMdDown=t.maxFoldersVisibleMdDown;n.isDroppable=s.observable(!0);n.isDroppingTarget=s.observable(!1);n.isOverflowOpen=s.observable(!1);n.overflowMenuOffset=s.observable(new l.e(-24,24));n.ariaLabelForBreadCrumbBar=s.observable("");n._openActionItem=s.observable(null);n.overflowCrumbs=s.observableArray();n.mouseOverTrigger=n.createObservable(!1);n._canShowTooltipOverflow=h;n._crumbs=t.crumbs;n._actionMap=n.resources.consume(y.e);n._openAction=new(n.managed(n._actionMap.OpenAction))({item:n._openActionItem,openRelation:2});n.overflowDismissParams={isOpen:n.isOverflowOpen,isAutomatic:n._canShowTooltipOverflow,timeout:100};n._dropHelper=n.resources.consume(f.e);n.crumbs=n.createComputed(function(){return n._computeCrumbs(t.getCrumbs)});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.crumbs.dispose()};t.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)};t.prototype.onMayReceiveDrop=function(e,t){var n=t?s.dataFor(t):null;if(n&&n.item&&n.showNextChevron){this.onRemoveDropLocation();this._currentDroppingCrumb=n;this._currentDroppingCrumb.isDroppingTarget(!0);return{targetName:n.item.name}}this.onRemoveDropLocation();return null};t.prototype.onReceiveDrop=function(e,t){var n=t?s.dataFor(t):null,r=this._dropHelper.processDrop(e,n.item);r&&this.onRemoveDropLocation();return r};t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)};t.prototype.onEnter=function(e,t){t.stopPropagation()};t.prototype.onClick=function(e,t){if(e.onClick)e.onClick(e,t);else if(e.isOverflow)this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen());else if(e.item&&!e.isFiltered){this._openActionItem(e.item);this._openAction.execute(t)}else{this._navigation.navigateTo(e.url)}e&&this.ariaLabelForBreadCrumbBar(E.format(w.t,e.ariaLabel?e.ariaLabel:e.name))};t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,n=[],r=[],i=this._responsiveUI;t=i.compareSize(i.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var s=this._item(),o=[];this._crumbs?o=this._crumbs():s&&s.key&&(e?o=e(s):this._getParentItem(s)&&(o=this._getCrumbsForNonRoots(s)));for(var u=0;u<o.length;u++)n.length<t?n.unshift(o[u]):r.unshift(this._commandForCrumb(o[u]));r.length&&n.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""});this.overflowCrumbs().forEach(function(e){e.dispose()});this.overflowCrumbs(r);n&&n.length>0?n[n.length-1].ariaLabel?this.ariaLabelForBreadCrumbBar(E.format(w.t,n[n.length-1].ariaLabel)):this.ariaLabelForBreadCrumbBar(E.format(w.t,s&&s.key?s.name:n[n.length-1].name)):s&&s.key&&this.ariaLabelForBreadCrumbBar(E.format(w.t,s.name));return n};t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],n=!1,r=this._getAriaLabelsForBreadCrumbs(e);e;){var i=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),o=i.isAvailable.peek();i.dispose();var u=n,a=!n;if(!o){u=!1;a=!0}if(e.isStub){u=!1;a=!0}var f=e.name,l={key:e.key,url:"#"+e.key,name:f&&"root"!==f?e.name:b.e,showNextChevron:n,isDroppingTarget:s.observable(!1),item:e,isOverflow:!1,isNavItem:u,isStaticItem:a,ariaLabel:r.pop()};t.push(l);n=!0;e=this._getParentItem(e)}return t};t.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],n=void 0;e;){if(n){n=E.format(w.e,n,e.name||b.e);t.push(n)}else{n=e.name||b.e;if(this._getParentItem(e)){var r=this._getParentItem(e);t.push(r.name)}}e=this._getParentItem(e)}return t};t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(o.e))({text:e.name,action:new(this.managed(p.e))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})};t.prototype._getParentItem=function(e){if(!S.e.isActivated("D99057A9-4CBD-49C0-8721-0C2D2A23ADC7","06/23/2021","Use item.parentKey and itemParentHelper to get parent of item")){var t=this._itemParentHelper.getParent(e);return t&&t()}return e.UNSAFE_parent};return t})(h.t),T=n(15).e({tagName:"ms-breadcrumb-bar",template:'<nav class="BreadcrumbBar" data-bind="attr:{\'aria-label\':ariaLabelForBreadCrumbBar}"><ul class="BreadcrumbBar-list" data-bind="foreach:crumbs,dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}"><li>\x3c!--ko if:isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href="javascript:;" aria-haspopup="true" data-bind="click:$component.onClick.bind($component),dismiss:$component.overflowDismissParams,attr:{\'aria-expanded\':$component.isOverflowOpen(),\'aria-label\':$component.overflowMenuAriaLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},class:$component.iconClass,event:{mouseover:$component.onOverflowMouseover.bind($parent)}">\x3c!--ko if:$parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if:isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" data-bind="text:name,click:$component.onClick.bind($component),keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},attr:{href:url,title:name},css:{dropping:isDroppingTarget}"></a>\x3c!--/ko--\x3e\x3c!--ko if:isStaticItem--\x3e<span class="BreadcrumbBar-item" data-bind="text:name,attr:{title:name}"></span>\x3c!--/ko--\x3e\x3c!--ko if:showNextChevron--\x3e<i class="BreadcrumbBar-item-chevron" role="presentation"></i>\x3c!--/ko--\x3e</li></ul></nav>',viewModel:x,synchronous:!0});t.e=T},1537:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});var r=n(3),i=new r.t("actionMap"),s=new r.t("agent"),o=new r.t("behavior"),u=new r.t("status")},1538:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return S});var r=n(0),i=n(7),s=n(14),o=n(25),u=n(171),a=n(81),f=n(32),l=n(31),c=n(126),h=n(82),p=n(334),d=n(405),v=n(242),m=n(113),g=n(40),y=n(1248),b=n(1006),w=n(77),E=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._albumDataSource=n.albumDataSource;r._operationProvider=n.operationProvider;r._itemProvider=n.itemProvider;r._urlDataSource=n.urlDataSource;r._tagProvider=n.tagProvider;r._isSingleAlbumItemsScopeEnabled=r.resources.consume(w.a);return r}t.prototype.addToAlbum=function(e){for(var t=this,n=new c.e,r=this.observables.createArray(e.items).map(function(r){var i=t._operationProvider.register({name:r.name,type:h.e.addItemsToAlbum,payloads:{addItemsToAlbum:{item:r,album:e.album}},iconName:r.iconName,batch:n});i.progress.maximum(1);i.progress.current(0);return i}),i=0,s=r();i<s.length;i++){s[i].state(l.e.started)}return this._albumDataSource.addToAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){if(!t._isSingleAlbumItemsScopeEnabled){t._itemProvider.invalidateItem(e.album.key);t._itemProvider.invalidateItem(t.getAlbumsParentKey())}for(var i=0,s=r();i<s.length;i++){var o=s[i];o.progress.current(1);o.state(l.e.completed)}return n},function(e){for(var t=0,n=r();t<n.length;t++){n[t].state(l.e.failed)}return o.n.wrapError(e)})};t.prototype.createAlbum=function(e,t){var n=this,r=[new p.e("createAlbum="+e.name,e.name)],i=e.keys;return this._albumDataSource.createAlbum(e.name,i).then(function(e){return n._getNewlyCreatedAlbum(e.id)}).then(function(e){r=e?r.map(function(t){return t.succeed(e)}):r.map(function(e){return e.fail(m.i)});t.update(r)},function(e){r=r.map(function(t){return t.fail(e.error)});t.update(r);return o.n.wrapError(e)})};t.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],n=0;n<e.length;n++)e[n].photo&&!e[n].video&&t.push(e[n].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)};t.prototype.removeFromAlbum=function(e){var t=this;return this._albumDataSource.removeFromAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){t._itemProvider.invalidateItem(t.getAlbumsParentKey());t._itemProvider.invalidateItem(e.album.key);return n},function(e){return o.n.wrapError(e)})};t.prototype.createAlbumFromFolder=function(e,n){for(var r=this,i=[new p.e("createAlbumFromFolder="+e.folder.id,e.folder.name)],s=0,u=i;s<u.length;s++){u[s].status=0}n.update(i);return this._albumDataSource.createAlbumFromFolder(e).then(function(e){return r._getNewlyCreatedAlbum(e.id)}).then(function(e){if(!e){var s=m.i;i=i.map(function(e){return e.fail(s)});n.update(i);return o.n.wrapError(s)}var u=null,a=function(){var s={type:d.e.albumFolderExtraction};u&&(s.workItemIds=u);r._itemProvider.getWorkProgress(s).done(function(s){var o;s.progress&&s.progress.length&&(o=s.progress[0]);if(o&&o.status!==v.e[v.e.Completed]){u||(u=[o.id]);r.async.setTimeout(a,t.ASYNC_DELAY)}else{i=i.map(function(t){return t.succeed(e)});n.update(i)}},function(e){i=i.map(function(e){return e.fail(m.i)});n.update(i)})};r.async.setTimeout(a,t.ASYNC_DELAY)},function(e){var t=m.i,r=new Error(t);i=i.map(function(e){return e.fail(r)});n.update(i);return o.n.wrapError(r)})};t.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});return this._albumDataSource.getAlbumsParentKey(e)};t.prototype.setCoverPhoto=function(e,t){var n=this,r=this.getAlbumsParentKey(),i=[new p.e(r+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(s){n._itemProvider.invalidateItem(r);n._itemProvider.invalidateItem(e.album.key);i=i.map(function(e){return e.succeed(s.id)});t.update(i)},function(e){var n=new Error(e);i=i.map(function(e){return e.fail(n)});t.update(i);return o.n.wrapError(n)})};t.prototype.saveAutoAlbum=function(e,t,n){var r=this,i=e.album,s=i.properties.newTag,u=new p.e(i.key,i);if(!b.s(i)){u=u.fail();n.update([u]);return o.n.wrap(void 0)}n.update([u]);return this._tagProvider.updateTags({items:[i],tagsToDelete:[s],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:y.n}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(i.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return o.n.wrapError(t)})};t.prototype.markAutoAlbumAsSeen=function(e,t){var n=e.properties.newTag,r=e.properties.autoAlbumTag;return n&&r?this._tagProvider.updateTags({items:[e],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){return e&&!e.error},function(e){return!1}):o.n.wrap(!1)};t.prototype.convertToAutoAlbum=function(e,t,n){var r=this,i=e.properties.newTag,s=e.properties.autoAlbumTag,u=new p.e(e.key,e);if(i){u=u.fail();n.update([u]);return o.n.wrap(void 0)}i={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"};s||(s={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"});return this._tagProvider.updateTags({items:[e],tagsToDelete:null,tagsToAdd:[s,i],rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(t){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:y.n}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(e.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return o.n.wrapError(t)})};t.prototype._getNewlyCreatedAlbum=function(e){var t=this.getAlbumsParentKey();this._itemProvider.invalidateItem(t);var n={parentKey:t,ownerId:this._urlDataSource.getOwnerId(t),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(n).then(function(t){for(var n=t.content.peek().items,r=n.length,i=0;i<r;i++){var s=n[i].peek();if(s.id===e)return s}})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{operationProvider:u.resourceKey,itemProvider:a.resourceKey,albumDataSource:s.e,urlDataSource:s.ye,tagProvider:f.T});t.ASYNC_DELAY=5e3;t.ASYNC_RETRY_LIMIT=5;t.ASYNC_RETRY_DELAY=15e3;return t})(i.n);t.default=E;var S=Object(g.s)("AlbumProvider",E)},1589:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(1038),i=new r.e("upload"),s=new r.e("download");new r.e("sync")},1591:function(e,t,n){"use strict";n.d(t,"t",function(){return d});var r=n(0),i=n(7),s=n(34),o=n(48),u=n(22),a=n(25),f=n(157),l=n(3),c=n(40),h=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageLayoutType=n.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new f.e);return r}t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");t.backgroundCompute(function(){var t=e._pageLayoutType(),r=o.a[t];e._debouncer.debounce(r?r().then(function(e){return e.tagName}):a.n.wrap("")).then(function(e){n(e)})});return n};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageLayoutType:u.o.layoutType});return t})(i.n),p=new l.t({name:"ToggleListLayoutHelper.layoutTypeResolver",factory:new c.n(h)}),d=new l.t({name:"ToggleListLayoutHelper.resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:p},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}}),v=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.pageLayoutType=n.resources.consume(u.o.layoutType);return n}t.prototype.changeLayout=function(e){var t=this;return(0,o.a[e])().then(function(n){t.pageLayoutType(n.tagName);return a.n.resolve({resultType:s.e.Success,extraData:{layout:e}})})};return t})(i.n);t.e=v},1592:function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"o",function(){return h});n.d(t,"r",function(){return p});n.d(t,"u",function(){return d});n.d(t,"i",function(){return v});n.d(t,"s",function(){return m});n.d(t,"n",function(){return g});var r=n(393),i=n(653),s=n(735),o=n(755),u=n(1060),a=new r.e("itemSetTypeFilterHandler");function f(e){return{key:a.serializeNext(),filter:e}}var l=f(function(e,t){return!!e.demandItemFacet(i.m,t.itemKey)}),c=f(function(e,t){return!e.demandItemFacet(i.m,t.itemKey)}),h=f(function(e,t){var n;if(e.demandItemFacet(s.p,t.itemKey))return!0;var r=null===(n=e.demandItemFacet(i.d,t.itemKey))||void 0===n?void 0:n.extension;if(r){if("photo"===Object(u.e)(r))return!0}return!1}),p=f(function(e,t){var n;if(e.demandItemFacet(s.p,t.itemKey))return!1;var r=null===(n=e.demandItemFacet(i.d,t.itemKey))||void 0===n?void 0:n.extension;if(r){if("photo"===Object(u.e)(r))return!1}return!0}),d=f(function(e,t){var n;if(e.demandItemFacet(s.g,t.itemKey))return!0;var r=null===(n=e.demandItemFacet(i.d,t.itemKey))||void 0===n?void 0:n.extension;if(r){if("video"===Object(u.e)(r))return!0}return!1}),v=f(function(e,t){var n;if(e.demandItemFacet(s.g,t.itemKey))return!1;var r=null===(n=e.demandItemFacet(i.d,t.itemKey))||void 0===n?void 0:n.extension;if(r){if("video"===Object(u.e)(r))return!1}return!0}),m=f(function(e,t){return!!e.demandItemFacet(o.i,t.itemKey)}),g=f(function(e,t){return!e.demandItemFacet(o.i,t.itemKey)})},1643:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e,t){var n=function(n){var i=e.peek(),s=t.peek();t.valueWillMutate();s.splice.apply(s,Object(r.__spreadArrays)([0,s.length],i));t.valueHasMutated()},i=e.subscribe(n,null,"arrayChange");n();return i}},1644:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(40),s=new r.t({name:"LegacyDetailsPaneHost.key",loader:new i.t(function(){return n.ee([139,"deferred.resx-deferred"],2078).then(function(e){return e.resourceKey.local})})})},1689:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return d});var r=n(0),i=n(10),s=n(27),o=n(156),u=n(1644),a=n(267),f=n(7),l=n(423),c=n(239),h=n(2112),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.infoPaneRegionLabel="";r.transclusionContentTagName=c.e.tagName;r.addBindingHandlers({control:s.n});r.isInfoPaneExpanded=n.isInfoPaneExpanded;r.infoPaneTransclusionContentParams={provider:n.infoPaneTransclusionProvider};r.infoPaneRegionLabel=h.e;r.infoPaneRole=r.observables.create("complementary");r.infoPaneControlParams={specification:Object(s.r)(u.e,{}),placeholder:Object(s.r)(a.t,{})};return r}t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.n.dependencies),{infoPaneTransclusionProvider:l.e,isInfoPaneExpanded:o.e});return t})(i.t),d=Object(s.t)({name:"DetailsPaneTransclusionContent",template:"\x3c!--ko if:isInfoPaneExpanded()--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:infoPaneTransclusionContentParams}--\x3e<div data-bind=\"control:infoPaneControlParams,attr:{'aria-label':infoPaneRegionLabel,role:infoPaneRole}\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e",automationName:"ms-details-pane-transclusion-component",viewModelType:p});t.default=d},1702:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1),s=n(7),o=n(40),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=r._controls=r.observables.createArray([]),o=document.createElement("div");o.style.display="none";var u=document.createElement("div");u.setAttribute("data-bind","component: $data");document.body.appendChild(o);i.applyBindingsToNode(o,{template:{nodes:[u],foreach:s}});return r}t.prototype.requestControl=function(e){this._controls.push(e);return e};t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)};return t})(s.n),a=Object(o.s)("HiddenDomProvider",u)},1704:function(e,t,n){"use strict";var r=n(17),i=Object(r.Mi)(r.lt),s=i?window.require.toUrl("odsp-media/fluenthybridfont/"):window.require.toUrl("odsp-media/fonts/");(i?function(){return n.ee([354],2210)}:function(){return n.ee([353],2211)})().then(function(e){(0,e.initializeIcons)(s,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)})},1705:function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(0),i=n(51),s=n(653),o=new i.e("itemSetExtensionFilterHandler",{extension:Object(i.s)({shouldNormalizeCasing:!0}),exclude:Object(i.n)()});function u(e){if(o.matches(e.key)){var t=o.deserialize(e.key),n=t.extension;return(t.exclude?"!":"")+n}}function a(e,t){return{key:o.serialize(Object(r.__assign)({extension:e},void 0!==t?{exclude:t}:{})),filter:function(n,r){var i=n.demandItemFacet(s.d,r.itemKey);if(i){var o=i.extension===e;return t?!o:o}return!1}}}},1831:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(1038).e)("defaultClick")},2005:function(e,t,n){"use strict";n.d(t,"r",function(){return i});n.d(t,"e",function(){return s});n.d(t,"u",function(){return o});n.d(t,"l",function(){return u});n.d(t,"f",function(){return a});n.d(t,"n",function(){return f});n.d(t,"t",function(){return l});n.d(t,"s",function(){return c});n.d(t,"o",function(){return h});n.d(t,"a",function(){return p});n.d(t,"i",function(){return d});var r,i="msa_client_id",s="aad_client_id",o="ru",u="view_type",a="selection_mode",f="link_type",l="access",c="prompt",h="select_account",p=((r={})[1]=0,r[0]=1,r),d=1e3},2108:function(e,t,n){"use strict";var r=n(0),i=n(25),s=n(187),o=n(8),u=n(48),a=n(5),f=n(20),l=n(1591),c=n(14),h=n(85),p=n(77),d=n(94),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="ToggleListLayout";n._layoutType=u.d(t.layoutType);n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter;n._currentItem=n.resources.consume(a.s);n._viewParams=n.resources.consume(a.H);n._actionMap=n.resources.consume(a.e);n._urlDataSource=n.resources.consume(c.ye);n._helper=new(n.managed(l.e));return n}t.prototype.onIsAvailable=function(){var e=this.resources.consume(p.n),t=this._currentItem(),n=t&&t.queryType,r=t.key!==this._urlDataSource.getRootItemKey(o.e.SharedWithMe)&&n!==o.e.DocsInCommon;e||(r=r&&n!==o.e.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),s=t.virtualItemType!==d.e.Album;this._layoutType===u.l&&(s=n===o.e.Files);e&&n===o.e.AllMyPhotos&&(s=!("allmyphotos"!==i.qt||i.tagFilter||i.locationFilter||i.onThisDay||i.onThisMonth||i.lastWeekPreviousYears));"allmyphotos"===i.qt&&(s=this._layoutType!==u.s&&this._layoutType!==u.n);return r&&s};t.prototype.onExecute=function(e,t){var n,r=this;if(this._shouldClearContextualFilter){var s=h.e({},this._viewParams.peek());delete s.ft;n=new(this.managed(this._actionMap.NavigationAction))({url:"#"+f.n(s)}).execute(e)}else n=i.n.wrap();return n.then(function(){return r._helper.changeLayout(r._layoutType)},function(){return r._helper.changeLayout(r._layoutType)})};t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()};return t})(s.e);t.e=v},2214:function(e,t,n){"use strict";var r=n(12);Object(r.n)([{rawString:".od-ButtonBar{display:block;height:30px}[dir=ltr] .od-ButtonBar .od-Button{margin-right:10px}[dir=rtl] .od-ButtonBar .od-Button{margin-left:10px}[dir=ltr] .od-ButtonBar .od-Button:last-child{margin-right:0}[dir=rtl] .od-ButtonBar .od-Button:last-child{margin-left:0}.od-ButtonBar-main{display:block;height:30px;white-space:nowrap}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px 20px}.od-ButtonBarCommand-icon{display:inline-block}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}]);var i=n(15),s=n(0),o=n(10),u="od-button-bar-command-button",a="od-button-bar-command-text",f=n(247),l=n(1),c=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._index=t.index;n.command=t.command;n.focused=l.observable(!1);n.selected=l.observable(!1);n.templateName=n.createPureComputed(n._computeTemplateName);n.isPrimary=n.createPureComputed(n._computeIsPrimary);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeTemplateName=function(){return!this.command.action||!this.unwrapObservable(this.command.isPermanent)&&this.command.isDisabled()?a:u};t.prototype._computeIsPrimary=function(){return 0===this._index()};t.prototype._computeState=function(){return f.e[this.command.state()||f.e.initialized]};return t})(o.t);i.e({tagName:"od-button-bar-command",template:"\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e",viewModel:c,synchronous:!0});i.t(u,'<button class="od-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr:{title:command.tooltip},css:{\'is-disabled\':command.isDisabled,\'is-focused\':command.focused,\'od-Button--primary\':isPrimary},hasFocus:command.isActive,disable:command.isDisabled,click:command.onClick.bind(command)">\x3c!--ko if:command.icon--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-Button-label od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</button>');i.t(a,'<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="class:\'od-ButtonBarCommand--\'+state()">\x3c!--ko if:command.icon--\x3e<span class="od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</span>');var h=n(71),p=n(269),d=n(43),v=(function(){function e(){}e.init=function(t,n,r){var i=l.observable();l.computed(function(){i();var s=l.utils.unwrapObservable(n()),o=r(),u=null;u=s.data?s.data:o.foreach&&o.foreach.data||o.foreach||o.template&&o.template.foreach;var a=s.responsiveUI.formFactorSize(),f=l.utils.unwrapObservable(u),c=l.utils.unwrapObservable(s.alwaysVisibleItems);e._calculateElementVisibility(t,s,f,c,a)},null,{disposeWhenNodeIsRemoved:t}).extend({throttle:1});var s=new d.t(t);l.utils.domNodeDisposal.addDisposeCallback(t,function(){s.dispose()});s.on(t,"layoutChange",function(e){i.notifySubscribers()});s.on(window,"resize",function(e){i.notifySubscribers()});s.on(document,"transitionend",function(e){i.notifySubscribers()})};e._calculateElementVisibility=function(t,n,r,i,s){if(r&&r.length){var o=t.getBoundingClientRect(),u=o.right-o.left,a=0,f=[],c=[];if(i&&r)for(var h=0,p=i.length;h<p;h++){var d=i[h],v=l.utils.arrayIndexOf(r,d);if(v>-1&&v<t.children.length){var m=t.children[v];u-=e._measureElement(m).width}}for(h=0,p=t.children.length;h<p;h++){m=t.children[h];var g="Small"===s&&h>0,y=void 0;r&&(y=r[h]);a+=e._measureElement(m).width;var b=i&&y&&l.utils.arrayIndexOf(i,y)>-1,w=!b&&(a>u||g);y&&l.isObservable(y.isClipped)&&y.isClipped(w);if(!b){var E="none"!==m.style.display;w||E?w&&E&&(m.style.display="none"):m.style.display=""}if(w){f.push(m);y&&c.push(y)}}if(n){l.isObservable(n.overflowElements)&&n.overflowElements(f);l.isObservable(n.overflowItems)&&n.overflowItems(c)}}};e._measureElement=function(e){var t=e.style.display;e.style.display="";var n=e.getBoundingClientRect(),r=window.getComputedStyle(e),i=parseFloat(r.marginLeft),s=parseFloat(r.marginRight),o=parseFloat(r.marginTop),u=parseFloat(r.marginBottom);e.style.display=t;return{left:n.left-i,right:n.right+s,top:n.top-o,bottom:n.bottom+u,width:n.right-n.left+i+s,height:n.bottom-n.top+o+u}};return e})(),m=n(65),g=n(1643),y=n(53),b=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;Object(r.t)();i._allCommands=l.observableArray();i.overflowCommands=l.observableArray();i.focusedCommand=l.observable();i.fixedCommands=[];i._overflowCommandsSubscription=null;i._commandSetCommandsReplicationSubscription=null;i.responsiveUI=i.resources.consume(y.n);i.addBindingHandlers({selection:p.e,overflow:v,keyboard:h.e,element:m.e});i._mainCommandsFirstTimeRendered=l.observable(!1);i.keyboardOptions=[{mappings:{Down:i.onNavigateDown,Enter:i.onEnter}},{target:document,mappings:{},allowButtonEvents:!0}];i._initializeCommandsObservables();i._initializeFocusLogic(!!t.focusOnFirstCommand||!1);i._commandSet=i.wrapObservable(t.commandSet);i._initializeCommandSet(i._commandSet.peek());i.subscribe(i._commandSet,function(e){i._initializeCommandSet(e)});return i}t.prototype.getButtonBarItemParams=function(e,t){var n=this;return{command:e,index:4&e.location?this.observables.pureCompute(function(){return t()+n.mainCommands().length}):t}};t.prototype.onNavigateDown=function(e,t){var n=this.focusedCommand();n&&n.openMenu()&&t.preventDefault();return!1};t.prototype.onEnter=function(e,t){var n=this.focusedCommand();if(!n)return!0;var r=t.target.getElementsByTagName("input");if(!r||!r.length)return n.onClick(n,t);r[0].click();t.stopPropagation();t.preventDefault()};t.prototype.animateIn=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){l.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0);this.async.setTimeout(function(){l.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3)}};t.prototype.animateOut=function(e,t,n){if(n.hasAnimation&&1===e.nodeType){l.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0);this.async.setTimeout(function(){l.removeNode(e)},1e3)}else l.removeNode(e)};t.prototype._updateCommandKeyboardShortcuts=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.keys)for(var i=r.onClick.bind(r),s=0;s<r.keys.length;s++){var o=r.keys[s];e[o]||(e[o]=[]);e[o].push(i)}var u=r.children();u.length&&this._updateCommandKeyboardShortcuts(e,u)}};t.prototype._initializeCommandSet=function(e){var t=this;if(this._overflowCommandsSubscription){this._overflowCommandsSubscription.dispose();this._overflowCommandsSubscription=null}if(this._commandSetCommandsReplicationSubscription){this._commandSetCommandsReplicationSubscription.dispose();this._commandSetCommandsReplicationSubscription=null}this._allCommands([]);this.fixedCommands=[];this.keyboardOptions[1].mappings={};if(e){this._commandSetCommandsReplicationSubscription=g.e(e.commands,this._allCommands);this.addDisposable(this._commandSetCommandsReplicationSubscription);if(e.overflowHostCommand){this.fixedCommands.push(e.overflowHostCommand);this._overflowCommandsSubscription=this.createBackgroundComputed(function(){var n=t.overflowCommands().concat(t._overflowOnlyCommands());e.overflowHostCommand.children(n)})}this._mainCommandsFirstTimeRendered.peek()||this._mainCommandsFirstTimeRendered(!0)}};t.prototype._initializeCommandsObservables=function(){var e=this,t=this._allCommands,n=this._visibleCommands=this.addDisposable(t.filter(function(e){return e.isVisible()&&(function(e){return 0!=(23&e.location)})(e)}));this.mainCommands=this.addDisposable(n.filter(w));this._overflowOnlyCommands=this.addDisposable(t.filter(S));this.sideCommands=this.addDisposable(n.filter(E));this.selectableCommands=this.addDisposable(n.filter(function(t){return!(S(t)||e._isOverflowEnabled()&&e.overflowCommands.indexOf(t)>=0)&&!t.isDisabled()}));this.subscribe(t,function(t){var n={};e._updateCommandKeyboardShortcuts(n,t);e.keyboardOptions[1].mappings=n})};t.prototype._initializeFocusLogic=function(e){var t=this,n=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),r=this.createComputed(function(){return n().length>0});this.createComputed(function(){r()||l.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!t.topTab.peek()||t.topTab.peek().focus()}).extend({rateLimit:0});this.topTab=l.observable(null);this.subscribe(this._mainCommandsFirstTimeRendered,function(n){t.async.setImmediate(function(){n&&e&&t._focusOnFirstCommand()})})};t.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand};t.prototype._focusOnFirstCommand=function(){if(this._visibleCommands()&&this._visibleCommands().length>0){var e=this._visibleCommands()[0];e.focused(!0);this.focusedCommand(e)}};return t})(o.t);function w(e){return 3==(3&e.location)}function E(e){return 4==(4&e.location)}function S(e){return 2==(3&e.location)}var x=i.e({tagName:"od-button-bar",template:'<span class="od-ButtonBar" data-bind="keyboard:keyboardOptions,element:topTab"><span class="od-ButtonBar-main" data-bind="foreach:mainCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span><span class="od-ButtonBar-side" data-bind="foreach:sideCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span></span>',viewModel:b,synchronous:!0});t.e=x},2259:function(e,t,n){"use strict";var r=(function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t;window.name=JSON.stringify(n)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];delete t[e];window.name=JSON.stringify(t);return n};e.prototype._getNormalizedWindowName=function(){var e,t;try{t=JSON.parse(name)||{}}catch(e){t={}}"object"!=typeof t&&(t=((e={}).value=t,e));return t};return e})();t.e=r},2260:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.commandSets,i=void 0===r?[]:r;n._commandSets=n.wrapObservable(i);n.createComputed(n._computeUpdateCommandSet);return n}t.prototype._computeUpdateCommandSet=function(){for(var e,t,n=[],i=[],s=[],o=0,u=this._commandSets();o<u.length;o++){for(var a=u[o],f=this.observables.unwrap(a),l=[],c=0,h=f.commands();c<h.length;c++){var p=h[c];p===f.overflowHostCommand?s.push.apply(s,p.children()):4==(4&p.location)?l.push(p):n.push(p)}i.unshift.apply(i,l)}var d=this.overflowHostCommand.children.peek();(e=this.overflowHostCommand.children).splice.apply(e,Object(r.__spreadArrays)([0,d.length],s));n.push(this.overflowHostCommand);n.push.apply(n,i);(t=this.commands).splice.apply(t,Object(r.__spreadArrays)([0,this.commands.peek().length],n))};return t})(n(273).e);t.e=i},2362:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return P});n(1301),n(429),n(430),n(440);var r=n(0),i=n(10),s=n(5),o=n(22),u=n(1437),a=n(27),f=n(1479),l=n(12);Object(l.n)([{rawString:".lg .od-ItemContent-metadata,.md .od-ItemContent-metadata,.sm .od-ItemContent-metadata{font-size:14px}.xlg .od-ItemContent-metadata,.xxlg .od-ItemContent-metadata,.xxxlg .od-ItemContent-metadata,.xxxxlg .od-ItemContent-metadata{font-size:16px}.od-ItemContent-metadata-button{cursor:pointer;border-width:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-left:0;padding-right:0}.od-ItemContent-metadata-button i{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var c=n(332),h=n(2407),p=n(37),d=n(386),v=n(71),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({tooltip:d.e,keyboard:v.e});n.item=t.item;n._actionMap=n.resources.consume(s.e);n._showPermissionsAction=new(n.managed(n._actionMap.ShowPermissionsAction))({item:n.item,engagementSource:"GlyphClick"});n.sharedTooltip=h.t;n.sharedWithSomeIcon=h.n;n.sharedAriaLabel=n._getSharedGlyphAriaLabel();return n}t.prototype.onSharedIconClick=function(e,t){c.e.logData({name:"folderSharedIndicatorClicked"});this._showPermissionsAction.execute(t).done()};t.prototype._getSharedGlyphAriaLabel=function(){return p.format(h.e,this.item().name)};return t})(i.t),g=n(15).e({tagName:"folder-shared-indicator",template:'<button class="od-ItemContent-metadata od-ItemContent-metadata-button" data-bind="attr:{\'aria-label\':sharedAriaLabel},tooltip:{content:sharedTooltip},click:onSharedIconClick"><i class="ms-Icon ms-Icon--People" data-bind="icon:true,attr:{alt:sharedWithSomeIcon}"></i></button>',viewModel:m,synchronous:!0}),y=n(395),b=n(125),w=n(14),E=n(32),S=n(343),x=n(1591),T=n(4),N=n(1689),C=n(2408),k=n(8),L=n(190),A=n(1007),O=n(9),M=n(52),_=Object(A.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(2,3491)];case 1:return[2,e.sent().default]}})})}),D=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:a.n,react:L.t});r._urlDataSource=r.resources.consume(w.ye);r.breadcrumbBarTagName=f.e.tagName;r.emptyFolderControl=Object(a.r)(u.e,{isViewOnly:r.createPureComputed(r._computeIsViewOnly,{deferEvaluation:!0})});r.isQuotaBarVisible=r.createObservable(!1);var i=r.resources.consume(s.e);r._uploadAction=new(r.managed(i.UploadAction))({uploadProcessorType:b.e.Html5file});r.sharedIndicatorTagName=g.tagName;r.isShowSharedIndicator=r.createPureComputed(r._computeIsShowSharedIndicator);r.isSendTagsFeedbackVisible=r.createPureComputed(r._computeSendTagsFeedback);r._itemSetMonitor=r.resources.consume(y.e);r.footerItem=t.footerItem;r.itemSet=r._itemSetMonitor.itemSet;r.itemSetSelectionModel=r.resources.consume(s.C);r.contentRange=r.resources.consume(o.t);r.layoutType=r.resources.consume(x.t);r.isFixedLayout=r._computeIsFixedLayout();r.listViewContextMenuHelper=r.resources.isExposed(o.u)?r.resources.consume(o.u):void 0;r.title=r._itemSetMonitor.name;r.showBreadcrumb=r._itemSetMonitor.hasParent;r.showEmpty=r._itemSetMonitor.isEmpty;r.showList=r.observables.pureCompute(r._computeShowList);r.item=r._itemSetMonitor.item;r.storageSummaryString=C.e;r.totalUsedString=C.t;r.showTitle=r.createPureComputed(r._computeShowTitle,{deferEvaluation:!0});var l=r.resources.consume(E.e);r.createComputed(function(){var e=l&&l.getBundleInfo(2);e&&e.isLoaded()&&(r.itemSet()&&r._urlDataSource.isSearchPassThrough()?r.isQuotaBarVisible(!0):r.isQuotaBarVisible(!1))});r.detailsPaneSpecification=Object(a.r)(N.resourceKey,{});r.imageTagFeedbackControlParams={componentType:_,props:{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1,isSearchView:!0}};return r}t.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()};t.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()};t.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()};t.prototype._computeSendTagsFeedback=function(){return Object(T.isFeatureEnabled)(T.EnableTagsInODC)&&this.item().queryType===k.e.Search&&this._urlDataSource.getPageType()===O.e.Photos};t.prototype._computeIsShowSharedIndicator=function(){if(Object(T.isFeatureEnabled)(T.EnableFolderShareAccessHint)){var e=this.item().sharingType;return e===S.e.Shared||e===S.e.Public||e===S.e.PublicUnlisted}return!1};t.prototype._computeIsFixedLayout=function(){return!M.e.isActivated("0F3F9AF2-9836-4DCE-B164-F22F3E6AC307","05/14/2021","Allows details list to use fixed columns to enable horizontal scrolling")};return t})(i.t),P=Object(a.t)({name:"FolderItemContent",automationName:"od-folder-item-content",template:'<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<h1 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text:title"></h1>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShowSharedIndicator--\x3e<div class="od-ItemContent-header-sharedIndicator" data-bind="component:{name:sharedIndicatorTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isSendTagsFeedbackVisible--\x3e<div class="od-FolderItemContent-tagsFeedback od-ItemContent-tagsFeedback" data-bind="react:imageTagFeedbackControlParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:isQuotaBarVisible--\x3e<div class="StorageInfo-sectionHeading" data-bind="text:storageSummaryString"></div><div class="od-ItemContent-progress-container"><div class="StorageInfo-totalUsed" data-bind="text:totalUsedString"></div><div class="od-ItemContent-progress" data-bind="component:{name:\'od-quota-progress-bar\'}"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:{itemSet:itemSet,selectionModel:itemSetSelectionModel,requiredRange:contentRange,enableMarqueeSelection:true,contextMenuHelper:listViewContextMenuHelper,footerItem:footerItem,isFixedLayout:isFixedLayout}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e</div>\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e',viewModelType:D})},2402:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r="odcpicker"},2404:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("RootItemsTypeFilter.key")},2405:function(e,t,n){"use strict";var r=n(0),i=n(446),s=n(1538),o=n(32),u=n(25),a=n(198),f=n(48),l=n(95),c=n(1358),h=n(8),p=n(94),d=n(4),v=n(77),m=n(342),g=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._photoProvider=n.resources.consume(o.d);n._albumProvider=n.resources.consume(s.resourceKey);n._tagProvider=n.resources.consume(o.T);var r=n.viewParams.peek();if(r&&r.noRootId)n._allPhotosUserSettings=n.createObservable({rootId:"",isAscending:!1});else{n._allPhotosUserSettings=n._photoProvider.getAllPhotosSettings();n.createBackgroundComputed(n._computeAllPhotosSettings).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}n.createBackgroundComputed(n._markNewAutoAlbumAsSeen);n.createBackgroundComputed(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});return n}t.prototype.getDefaultLayoutForView=function(){var t=this.referenceItemSet(),n=this.layoutType.peek()||f.u;if(!t)return n;var r=t.context,i=t.item(),s=this.urlDataSource.getKeyParams(i.key);if(this._isGetItemRequest(r))if(i.isPlaceholder)switch(s.id){case"albums":n=f.e}else switch(i.virtualItemType){case p.e.Album:n=f.l;break;case p.e.AlbumRoot:n=f.e}else{switch(s.qt){case"allmyphotos":n=e.prototype.getDefaultLayoutForView.call(this)}switch(s.id){case"tags":case"places":n=f.h}}return n};t.prototype.isItemResolved=function(t){return e.prototype.isItemResolved.call(this,t)&&!!t.peek().itemFromServer};t.prototype.resolveIndices=function(e){for(var t=this,n=new a.e(6),r=this.itemSet.peek().content.peek().items,i=[],s=function(e){return function(){return t.itemProvider.getItem(e)}},o=0,f=e;o<f.length;o++){var l=r[f[o]];if(l&&l.peek()&&l.peek().key){var c={parentKey:l.peek().key,resultSetOptions:this.itemResultSetOptions};i.push(n.enqueue(s(c)))}}return u.n.all(i).then(function(){})};t.prototype.getOnThisDayContext=function(){var e=l.e.onThisDay,n=this.requiredRange.peek(),r=this._allPhotosUserSettings.peek().rootId,i=this.referenceRevision.peek(),s=this.currentItemKey.peek(),o=this.urlDataSource.getKeyParams(s),u=this.viewParams.peek(),a={parentKey:void 0,photoType:e,startIndex:n.start,endIndex:n.end,rootItemId:r,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:o.locationFilter,tagFilter:o.tagFilter},f=new Date;f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);var c=f.toISOString(),h=!0,p=!1;try{h=c=new Date(Date.parse(u.onThisDay)).toISOString();p=!!u.highlights&&!!u.highlights}catch(e){}a.startDate=c;a.onThisDay=h;a.highlights=p;return a};t.prototype.getCurrentItemSetSync=function(e){var t;if(this._isGetItemRequest(e)){t=this.itemProvider.getItemSync(e);"albums"===this.urlDataSource.getKeyParams(e.parentKey).id&&(t.item().displayName=m.e)}else{switch(e.photoType){case l.e.AllMyPhotos:case l.e.singleTag:case l.e.singlePlace:case l.e.singlePerson:case l.e.onThisDay:case l.e.onThisMonth:case l.e.lastWeekPreviousYears:t=this._photoProvider.getAllPhotosSync(e);break;case l.e.allTags:t=this._tagProvider.getAllTagsSync(e,c.e.allTags);break;case l.e.allPlaces:t=this._tagProvider.getAllTagsSync(e,c.e.allPlaces);break;default:t=this.itemSet.peek()}}return t};t.prototype.getCurrentItemSet=function(e){var t;if(this._isGetItemRequest(e)){switch(this.urlDataSource.getKeyParams(e.parentKey).id){case"albums":default:t=this.itemProvider.getItem(e)}}else switch(e.photoType){case l.e.AllMyPhotos:case l.e.singleTag:case l.e.singlePlace:case l.e.singlePerson:t=this._photoProvider.getAllPhotosForPage(e);break;case l.e.onThisDay:t=this._photoProvider.getOnThisDayPhotos(e);break;case l.e.allTags:t=this._tagProvider.getAllTags(e);break;case l.e.allPlaces:t=this._tagProvider.getAllPlaces(e);break;default:t=null}return t};t.prototype.computeCurrentContext=function(){var e,n=this.requiredRange(),r=this.viewParams(),i=this.referenceRevision(),s=this.urlDataSource.getPhotoType(r),o=this.currentItemKey();if(s===l.e.Albums){e={parentKey:o,queryType:h.e.AllMyPhotos,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r)}}else if(s===l.e.singleAlbum){var u=this.urlDataSource.getFocusItemKey(),a=null;u&&this.focusItemIndexInItemSet()<0&&(a=u);e={parentKey:o,queryType:h.e.AllMyPhotos,startKey:a,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r),resultSetOptions:this.itemResultSetOptions}}else if(s===l.e.allPeople)e=this._determineFaceContext();else{var f=this.urlDataSource.getKeyParams(o),c=void 0;"allmyphotos"!==f.qt||f.tagFilter||f.locationFilter||(c=this._allPhotosUserSettings().rootId);e=s===l.e.onThisDay?this.getOnThisDayContext():{parentKey:null,photoType:s,startIndex:n.start,endIndex:n.end,rootItemId:c,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:f.locationFilter,tagFilter:f.tagFilter,onThisMonth:f.onThisMonth,lastWeekPreviousYears:f.lastWeekPreviousYears}}return e};t.prototype._markNewAutoAlbumAsSeen=function(){var e=this.item();if(!Object(d.isFeatureEnabled)(d.EnableEvokeAlignments)&&e.properties.newTag&&e.properties.autoAlbumTag){var t=!1,n=this.viewParams();this.resources.consume(v.n)&&void 0===n.tagFilter&&(t=!0);this._albumProvider.markAutoAlbumAsSeen(e,t)}};t.prototype._determineFaceContext=function(){var e=this.requiredRange();return{startIndex:e.start,endIndex:e.end,parentKey:this.currentItemKey(),queryType:h.e.AllMyPhotos,sortField:"size",isAscending:!1,revision:this.referenceRevision()}};t.prototype._computeAllPhotosSettings=function(){var e=this._allPhotosUserSettings(),t=this.currentItemKey(),n=this.urlDataSource.getKeyParams(t),r=n.id,i=this.urlDataSource.getQueryType(n),s=!(n.locationFilter||n.tagFilter||n.onThisDay||n.onThisMonth||n.lastWeekPreviousYears);if(e&&r!==e.rootId&&i===h.e.AllMyPhotos&&s&&!this.focusItemKey()){n.id=e.rootId;this.navigation.navigateTo({url:this.urlDataSource.getItemUrl(this.urlDataSource.getKey(n),{viewParams:this.viewParams.peek()}),ignoreHistory:!0})}};t.prototype._computeRequestFocusItem=function(){var e,t=this.itemCacheToKOStoreDataSource();if(t)e=t.focusedKOItem();else{var n=this.focusItem();if(!n)return;e=n()}if(e&&!e.parentKey&&!e.isPlaceholder){var r=this.focusItemContext();this.trackPromise(this.itemProvider.getItem(r))}};t.prototype._isGetItemRequest=function(e){return!!e.parentKey&&!this.useItemCacheData()};t.REQUEST_PAGE_SIZE=100;return t})(i.e);t.e=g},2406:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(25),i=n(527),s=n(3),o=n(40),u=new s.t({name:"PhotosItemsScopeItemContent.key",loader:new o.t(function(){return Object(i.t)({path:"./PhotosItemsScopeItemContent",getModule:function(){return r.n.resolve(n.ee([182,"deferred.resx-deferred"],2797))},getExport:function(e){return e.knockoutResourceKey.local}})})})},2630:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("RootSourceTypeFilter.key")},2828:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return h});var r=n(0),i=n(562),s=n(10),o=n(2629),u=n(124),a=n(32),f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({dismiss:u.e});r.closeText=o.e;r.notification=n.notificationProvider.currentNotification;r.severityClass=r.createComputed(r._computeSeverityClass);r.iconClass=r.createComputed(r._computeIconClass);return r}t.prototype.dismiss=function(){var e=this.notification.peek();if(e&&e.canImplicitDismiss){e.dismiss();return!1}return!0};t.prototype.close=function(){var e=this.notification.peek();if(e&&e.showCloseButton){e.complete();return!1}return!0};t.prototype.onButtonClick=function(e,t){if(e&&e.action){e.action.execute(t);e.dismiss()}};t.prototype._computeSeverityClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:return"od-MessageBar--info";case 5:return"od-MessageBar--remove";case 4:return"od-MessageBar--error";case 3:return"od-MessageBar--severeWarning";case 2:return"od-MessageBar--warning";case 0:return"od-MessageBar--success"}};t.prototype._computeIconClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:case 2:return Object(i.C)("Info");case 5:return Object(i.C)("Blocked2");case 4:return Object(i.C)("ErrorBadge");case 3:return Object(i.C)("Warning");case 0:return Object(i.C)("Success")}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.t.dependencies),{notificationProvider:a.c,notificationManager:a.h});return t})(s.t),l=n(27),c=n(12);Object(c.n)([{rawString:".od-MessageBar{padding:8px;display:table;background-color:"},{theme:"infoBackground",defaultValue:"#f4f4f4"},{rawString:"}.od-MessageBar-icon,.od-MessageBar-text{display:table-cell;vertical-align:top}.od-MessageBar-icon{padding-right:8px;font-size:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-MessageBar-text{font-size:12px;font-weight:400}.od-MessageBar.od-MessageBar--warning{background-color:"},{theme:"warningBackground",defaultValue:"#fff4ce"},{rawString:"}.od-MessageBar.od-MessageBar--severeWarning{background-color:"},{theme:"severeWarningBackground",defaultValue:"#fed9cc"},{rawString:"}.od-MessageBar.od-MessageBar--severeWarning .od-MessageBar-icon{color:"},{theme:"severeWarning",defaultValue:"#a80000"},{rawString:"}.od-MessageBar.od-MessageBar--error{background-color:"},{theme:"errorBackground",defaultValue:"rgba(232,17,35,.2)"},{rawString:"}.od-MessageBar.od-MessageBar--error .od-MessageBar-icon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-MessageBar.od-MessageBar--remove{background-color:"},{theme:"errorBackground",defaultValue:"rgba(232,17,35,.2)"},{rawString:"}.od-MessageBar.od-MessageBar--remove .od-MessageBar-icon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-MessageBar.od-MessageBar--remove .ms-Icon{font-size:8px;margin-left:3px}.od-MessageBar.od-MessageBar--success{background-color:"},{theme:"successBackground",defaultValue:"#dff6dd"},{rawString:"}.od-MessageBar.od-MessageBar--success .od-MessageBar-icon{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-MessageBar.od-MessageBar--success .ms-Icon{font-size:12px;top:3px}.od-MessageBar.od-MessageBar--success .ms-Icon:before{margin-left:1px}.od-MessageBar.od-MessageBar--success .ms-Icon:after{font-size:8px;margin-left:3px;top:1px}.NotificationHost{position:relative}.od-Notification-close{font-size:12px;width:40px;cursor:pointer;border:none;background-color:transparent;position:absolute;top:0;bottom:0;padding-top:4px}[dir=ltr] .od-Notification-close{right:0}[dir=rtl] .od-Notification-close{left:0}.od-Notification{width:100%}.od-Notification .od-MessageBar{width:100%;padding:0}.od-Notification .od-MessageBar-content{padding:8px}.od-Notification .od-MessageBar-text{vertical-align:middle;cursor:default}.od-Notification .od-MessageBar-icon .ms-Icon--Info{display:block}[dir=ltr] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-right:40px}[dir=rtl] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-left:40px}.od-Notification .od-MessageBar--info{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Notification-link{white-space:nowrap}[dir=ltr] .od-Notification-link{padding-left:4px}[dir=rtl] .od-Notification-link{padding-right:4px}"}]);var h=Object(l.t)({automationName:"od-notification-host",name:"NotificationHost",template:'<div class="NotificationHost">\x3c!--ko with:notification--\x3e<div class="od-Notification" role="alert" data-bind="css:{\'od-Notification--canClose\':showCloseButton},dismiss:{isAutomatic:!!timeout,timeout:timeout,isOpen:isOpen,close:$component.dismiss.bind($component)}"><div class="od-Notification-content"><div class="od-MessageBar" data-bind="class:$component.severityClass"><div class="od-MessageBar-content"><div class="od-MessageBar-icon"><i class="ms-Icon" data-bind="class:$component.iconClass"></i></div><div class="od-MessageBar-text"><span data-bind="text:text"></span>\x3c!--ko if:action--\x3e<a class="od-Notification-link od-Link" href="javascript:;" data-bind="text:actionText,click:$component.onButtonClick.bind($component)"></a>\x3c!--/ko--\x3e</div></div></div></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Notification-close" data-bind="attr:{\'aria-label\':$parent.closeText,title:$parent.closeText},click:$component.close.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>',viewModelType:f})}}]);